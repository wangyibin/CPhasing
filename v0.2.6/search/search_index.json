{"config":{"lang":["en","zh"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Installation","text":"C-Phasing <p> Phasing and scaffolding polyploid genomes based on Pore-C, HiFi-C, Ultra-long, or Hi-C data</p> <p>.</p>"},{"location":"#introduction","title":"Introduction","text":"<p>One of the major problems with Hi-C scaffolding of polyploid genomes is a large proportion of ambiguous short-read mapping, leading to a high-level of switched or chimeric assemblies. Now, the long-read-based chromosome conformation capture technology, e.g., Pore-C, HiFi-C, provides an effective way to overcome this problem. Here, we developed a new pipeline, namely <code>C-Phasing</code>, which is specifically tailored for polyploid phasing by leveraging the advantage of Pore-C or HiFi-C data.  It also works on Hi-C data and diploid genome assembly.  </p> <p>The advantages of <code>C-Phasing</code>:      - High speed.      - High anchor rate of genome.     - High accuracy of polyploid phasing.   </p>"},{"location":"#installation","title":"Installation","text":"recommendedcondacustom <p>Download the CPhasing and activate environments by the <code>activate_cphasing</code> <pre><code>git clone https://github.com/wangyibin/CPhasing.git \n\n### activate environment\nsource ./CPhasing/bin/activate_cphasing\n\n### deactivate\nsource deactivate \n</code></pre></p> <p>Note</p> <p>For the first configuration, run it when the network is accessible.</p> <p>Note</p> <p>If you do not have direct access to the anaconda repository, you can set the mirror for pixi.</p> <p>Download the CPhasing and install environment by conda <pre><code>git clone https://github.com/wangyibin/CPhasing.git\n\ncd CPhasing\nconda env create -f environment.yml\nconda activate cphasing\n</code></pre> Add the following to the <code>~/.bash_profile</code> ~/.bash_profile<pre><code>export PATH=/path/to/CPhasing/bin:$PATH\nexport PYTHONPATH=/path/to/CPhasing:$PYTHONPATH\n</code></pre></p> <p>Note</p> <p>The hic pipeline require GLIBCXX_3.4.29, or you can add the following to the start of cphasing execute script, e.g.: <code>run.sh</code> run.sh<pre><code>export LD_LIBRARY_PATH=/path/to/anaconda3/envs/cphasing/lib:$LD_LIBRARY_PATH\n</code></pre></p> <ul> <li>Basic Usage <p>Use <code>pipeline</code> to run <code>cphasing</code>.  </p> <p>Basic Usage</p> </li> </ul> <ul> <li>Tutorials <p>Tutorials to help you know how to run <code>cphasing</code>. Tutorials  Pore-C  Hi-C</p> </li> </ul>"},{"location":"#install-c-phasing","title":"Install C-Phasing","text":"<p><pre><code>## Download C-Phasing and install python dependencies\ngit clone https://github.com/wangyibin/CPhasing.git\ncd CPhasing\npip install .\n</code></pre> Add following to the <code>~/.bash_profile</code> or <code>~/.bashrc</code> ~/.bash_profile<pre><code>export PATH=/path/to/CPhasing/bin:$PATH\n</code></pre></p>"},{"location":"#dependencies","title":"Dependencies","text":"<ol> <li>For core function     - bedtools     - seqkit     - pigz </li> <li>For Pore-C pipeline      - minimap2(&gt;= v2.24)  </li> </ol>"},{"location":"CHANGES/","title":"CHANGES","text":""},{"location":"CHANGES/#v026-2025-03-27","title":"[v0.2.6] - 2025-03-27","text":""},{"location":"CHANGES/#new-features","title":"New features","text":"<ul> <li><code>collapse</code>, rescue the collapsed contigs  </li> </ul>"},{"location":"CHANGES/#enhancement","title":"Enhancement","text":"<ul> <li>Parameter optimization.</li> <li>Supported pairs.pqs processing.</li> <li><code>chimeric</code>, improve the performance that avoids too high of false correct</li> <li><code>pipeline</code>, if input pairs or pairs.gz, it will first convert it to pairs.pqs to speed up subsequence pairs data load. About a 15 percent increase in speed.</li> <li><code>plot</code>, enable plot the border or haplotypes (<code>--add-hap-border</code>)</li> </ul>"},{"location":"CHANGES/#bug-fixes","title":"Bug fixes","text":"<ul> <li><code>pipeline</code>, fixed bug that when user input uncommon suffix of Hi-C data (e.g. \"_R1.f.fastq.gz\") the pairs file could not be found. #issue17</li> <li><code>hypergraph</code>     - fixed bug that <code>cphasing-rs pairs-intersect</code> can not filter contacts by mapq     - fixed bug that report error when edge_length set to 0</li> <li><code>pairs2cool</code>, fixed bug that loss contacts when the chromsizes in <code>pairs.gz</code> is unsorted. </li> <li><code>rename</code>     - fixed bug that when the chromname in agp is named group??, the <code>rename</code> cannot be executed     - generate the unrenamed chromosome, #issue16</li> </ul>"},{"location":"CHANGES/#v025-2025-02-07","title":"[v0.2.5] - 2025-02-07","text":""},{"location":"CHANGES/#new-features_1","title":"New features","text":"<ul> <li><code>PQS</code>, custom format of contacts to speed up the load and parse, do not used in this version.</li> </ul>"},{"location":"CHANGES/#enhancement_1","title":"Enhancement","text":"<ul> <li><code>cphasing-rs</code>, slightly speed up <code>pairs2clm</code></li> <li><code>rename</code>, use g1, g2, g3 ... to rename duplicates chromosomes, when <code>--unphased</code> specified.</li> <li><code>hcr_by_contacts</code>, speed up it</li> </ul>"},{"location":"CHANGES/#bug-fixes_1","title":"Bug fixes","text":"<ul> <li><code>hypergraph</code>, fixed bug that report error of polars prompt of set \"skip_nulls=False\"</li> </ul>"},{"location":"CHANGES/#v024-2025-01-25","title":"[v0.2.4] - 2025-01-25","text":""},{"location":"CHANGES/#enhancement_2","title":"Enhancement","text":"<ul> <li><code>pairs2depth</code>, speed up by pipeline</li> <li><code>alleles</code>, add <code>--trim-length</code> to trim the both end of contigs to remove the                  effect of overlapping from hifiasm assembly graph.</li> <li><code>pipeline</code>     - <code>--preset precision</code>: Optimize parameters to improve accuracy at the expense of anchor rate     - <code>--preset sensitive</code>: Using in some complex genome, which contain many fragmented contigs and low signals contigs</li> </ul>"},{"location":"CHANGES/#bug-fixes_2","title":"Bug fixes","text":"<ul> <li><code>activate_cphasing</code>, fixed bug that exit shell window when pixi failed to install</li> <li><code>pipeline</code>     - fixed bug that program can not exit when error occurred      - fixed bug that alleles parameters cannot affect in phasing mode     - fixed bug that reported in issue #14, which <code>--chimeric-correct</code> mode cannot use correct fasta in 3.hyperpartition</li> <li><code>plot</code>, fixed bug that program can not coarsen adjusted matrix to plot another binsize matrix</li> </ul>"},{"location":"CHANGES/#v023-2025-01-14","title":"[v0.2.3] - 2025-01-14","text":""},{"location":"CHANGES/#enhancement_3","title":"Enhancement","text":"<ul> <li><code>pipeline</code>, report peak memory usage</li> <li><code>hyperpartition</code>     - add <code>--min-cis-weight=5.0</code> to remove low contacts contigs     - increase <code>--min-contacts</code> to <code>25.0</code> to remove low contacts contigs</li> </ul>"},{"location":"CHANGES/#bug-fixes_3","title":"Bug fixes","text":"<ul> <li><code>pairs2cool</code>, fixed bug that \"bin1_id &gt; bin2_id\" in some cases</li> </ul>"},{"location":"CHANGES/#v022-2025-01-10","title":"[v0.2.2] - 2025-01-10","text":""},{"location":"CHANGES/#enhancement_4","title":"Enhancement","text":"<ul> <li><code>pipeline</code>, When mode=phasing, pipeline integrating 1.alleles into 3.hyperpartition to speed up</li> </ul>"},{"location":"CHANGES/#bug-fixes_4","title":"Bug fixes","text":"<ul> <li><code>prepare</code>, fixed bug of \"got unexpected keyword argument <code>has_header</code>'</li> </ul>"},{"location":"CHANGES/#v021-2025-01-07","title":"[v0.2.1] - 2025-01-07","text":""},{"location":"CHANGES/#enhancement_5","title":"Enhancement","text":"<ul> <li><code>hypergraph</code>, add hcr_bed filter step.</li> <li><code>hyperpartition</code>, speed up the <code>phasing</code> mode</li> <li><code>activate_cphasing</code>, use pixi to activate the environment of CPhasing</li> <li><code>pairs2cool</code>, speed up it at the expense of memory consumption</li> <li><code>plot</code>, speed up it</li> </ul>"},{"location":"CHANGES/#bug-fixes_5","title":"Bug fixes","text":"<ul> <li><code>alleles</code>, a cheat method to fix bug of partig can not parse contig &gt; 130 Mb</li> <li><code>rename</code>, bug of read agp</li> <li><code>pipeline</code>     - input hic with <code>_1</code> or <code>_2</code> suffix can not load successful     - input hic can not find fastq path in <code>output dir</code></li> </ul>"},{"location":"CHANGES/#v020-2024-10-1","title":"[v0.2.0] - 2024-10-1","text":""},{"location":"CHANGES/#enhancement_6","title":"Enhancement","text":"<ul> <li><code>pipeline</code>     - change the normalization method of the hic pipeline     - change pipeline output directories</li> <li><code>hyperpartition</code>, improve the performance of cluster merge</li> </ul>"},{"location":"CHANGES/#bug-fixes_6","title":"Bug fixes","text":"<ul> <li><code>plot</code>, fixed bug of split contigs</li> </ul>"},{"location":"CHANGES/#v019-2024-07-09","title":"[v0.1.9] - 2024-07-09","text":""},{"location":"CHANGES/#new-features_2","title":"New features","text":"<ul> <li><code>collapsed-rescue</code>, init a collapsed contigs rescue function</li> </ul>"},{"location":"CHANGES/#enhancement_7","title":"Enhancement","text":"<ul> <li><code>higig</code>     - support for hifi data. Moreover, support for junk and collapsed identification     - <code>correct-alignments</code>, increase performance by filtering low quality LIS</li> <li><code>pairs2cool</code>, add min_mapq filtering</li> <li><code>plot</code>, add triangle plot </li> <li><code>scaffolding</code>, speed up split clm by <code>cphasing-rs splitclm</code></li> <li><code>alleles</code>, speed up</li> </ul>"},{"location":"CHANGES/#bug-fixes_7","title":"Bug fixes","text":"<ul> <li><code>pipeline</code>      - fixed bug of contacts generating     - fixed bug of the <code>corrected.agp</code> not output when chimeric correct mode</li> <li><code>scaffolding</code>, fixed bug of countre extract not found contigs </li> <li><code>hcr_from_contacts</code>, find error peak in low coverage regions</li> </ul>"},{"location":"CHANGES/#v018-2024-05-15","title":"[v0.1.8] - 2024-05-15","text":""},{"location":"CHANGES/#enhancement_8","title":"Enhancement","text":"<ul> <li><code>hypergraph</code>, <code>Extractor</code>, add mapq to hypergraph</li> <li><code>remove_misassembly</code>, add remove_misassembly of error between homologous chromosome</li> </ul>"},{"location":"CHANGES/#bug-fixes_8","title":"Bug fixes","text":"<ul> <li><code>plot</code>, fixed bug of resolution not in filename</li> </ul>"},{"location":"CHANGES/#v017-2024-05-11","title":"[v0.1.7] - 2024-05-11","text":""},{"location":"CHANGES/#enhancement_9","title":"Enhancement","text":"<ul> <li><code>hypergraph</code>, speed up data loading</li> <li><code>scaffolding</code>, speed up clm loadding </li> </ul>"},{"location":"CHANGES/#v016-2024-05-07","title":"[v0.1.6] - 2024-05-07","text":""},{"location":"CHANGES/#enhancement_10","title":"Enhancement","text":"<ul> <li><code>hcr_by_contacts</code>, remove whole collapsed contigs </li> <li><code>stat_porec_table</code>, reduce memory usage</li> </ul>"},{"location":"CHANGES/#bug-fixes_9","title":"Bug fixes","text":"<ul> <li><code>scaffolding</code>, length db not load contig that RE count &lt; 3</li> <li><code>simulate_collapse</code>, fixed bug of contig position in collapsed contigs</li> </ul>"},{"location":"CHANGES/#v015-2024-04-29","title":"[v0.1.5] - 2024-04-29","text":""},{"location":"CHANGES/#enhancement_11","title":"Enhancement","text":"<ul> <li>environment, add pigz </li> <li><code>hic mapper</code>, add \"remove pcr duplicates\" as default parameters</li> </ul>"},{"location":"CHANGES/#v014-2024-04-23","title":"[v0.1.4] - 2024-04-23","text":""},{"location":"CHANGES/#enhancement_12","title":"Enhancement","text":"<ul> <li>colorful the help text</li> <li><code>hcr</code>, use kde peaks </li> <li><code>pipeline</code>, use </li> </ul>"},{"location":"CHANGES/#v013-2024-04-22","title":"[v0.1.3] - 2024-04-22","text":""},{"location":"CHANGES/#new-features_3","title":"New features","text":"<ul> <li><code>_chromap</code>, add a modified <code>chromap</code></li> </ul>"},{"location":"CHANGES/#enhancement_13","title":"Enhancement","text":"<ul> <li><code>hypergraph</code>, reduce memory usage</li> </ul>"},{"location":"CHANGES/#v012-2024-04-18","title":"[v0.1.2] - 2024-04-18","text":""},{"location":"CHANGES/#enhancement_14","title":"Enhancement","text":"<ul> <li><code>scaffolding</code>, optimized</li> <li><code>cphasing-rs pairs2clm</code>, speed up</li> </ul>"},{"location":"CHANGES/#v011-2024-04-11","title":"[v0.1.1] - 2024-04-11","text":""},{"location":"CHANGES/#new-features_4","title":"New features","text":"<ul> <li><code>hitig</code>     - <code>scaffolding</code>, which enable to scaffolding by ultra-long reads.</li> </ul>"},{"location":"CHANGES/#enhancement_15","title":"Enhancement","text":"<ul> <li><code>plot</code>, speed up</li> <li><code>alleles</code>, remove filter function</li> <li><code>hypergraph</code>, speed up by porec table load.</li> </ul>"},{"location":"CHANGES/#v010-2024-04-07","title":"[v0.1.0] - 2024-04-07","text":""},{"location":"CHANGES/#new-features_5","title":"New features","text":"<ul> <li><code>alleles2</code>, a method for allelic contig identification by self mapping</li> <li><code>cphasing-rs prune</code>, a method to prune by raw allele table (ALLHiC allele table)</li> </ul>"},{"location":"CHANGES/#enhancement_16","title":"Enhancement","text":"<ul> <li><code>scaffolding</code>, increase the performance of long contigs</li> </ul>"},{"location":"CHANGES/#bug-fixes_10","title":"Bug fixes","text":"<ul> <li><code>plot</code>, fixed bug that it can not be used in pandas v2.0</li> </ul>"},{"location":"CHANGES/#v0064-2024-03-11","title":"[v0.0.64] - 2024-03-11","text":""},{"location":"CHANGES/#bug-fixes_11","title":"Bug fixes","text":"<ul> <li><code>hyperpartition</code>, fixed the inconsistent of phasing results, when specified alleletable and prunetable</li> <li><code>alleles</code>, filterring by valid kmer length of contigs</li> </ul>"},{"location":"CHANGES/#v0062-2024-02-18","title":"[v0.0.62] - 2024-02-18","text":""},{"location":"CHANGES/#new-features_6","title":"New features","text":"<ul> <li><code>cphasing-rs</code> <code>kprune</code>, increase the recall of cross-allelic</li> </ul>"},{"location":"CHANGES/#v0061-2024-01-19","title":"[v0.0.61] - 2024-01-19","text":""},{"location":"CHANGES/#new-features_7","title":"New features","text":"<ul> <li><code>plot_high_order_distribution.py</code>, plot the contact order distribution of pore-c alignments</li> </ul>"},{"location":"CHANGES/#enhancement_17","title":"Enhancement","text":"<ul> <li><code>scaffolding</code>, adopt the HapHiC_sort to scaffolding, and add HaplotypeAlign</li> <li><code>partig</code>, change <code>d</code> to <code>0.1</code></li> <li><code>AlleleTable</code>, add <code>strand</code> column to the format of <code>allele2</code></li> <li><code>Tour</code>, add <code>to_dict</code>, <code>backup</code>, <code>save</code></li> </ul>"},{"location":"CHANGES/#v0060","title":"[v0.0.60]","text":""},{"location":"CHANGES/#enhancement_18","title":"Enhancement","text":"<ul> <li><code>hyperpartition</code>, add prune based on hypergraph</li> <li><code>hyperpartition</code>, add different n setting</li> <li><code>pipeline</code>, remove single kprune, change it to hypergraph prune</li> </ul>"},{"location":"CHANGES/#v0059","title":"[v0.0.59]","text":""},{"location":"CHANGES/#enhancement_19","title":"Enhancement","text":"<ul> <li><code>hyperpartition</code>, add automatic search resolution</li> <li><code>kprune</code>, update the formulate of normalization</li> </ul>"},{"location":"CHANGES/#v0058","title":"[v0.0.58]","text":""},{"location":"CHANGES/#enhancement_20","title":"Enhancement","text":"<ul> <li><code>mapper</code>, add restriction site filter and realign</li> <li><code>hyperpartition</code>, new mode by phasing</li> <li><code>hyperpartition</code>, support import pore-c table or pairs</li> <li><code>HyperEdges</code>, add contigsizes, mapq</li> </ul>"},{"location":"CHANGES/#v0057","title":"[v0.0.57]","text":""},{"location":"CHANGES/#enhancement_21","title":"Enhancement","text":"<ul> <li><code>pipeline</code>, add <code>hcr</code></li> <li><code>hcr</code>, optimized</li> </ul>"},{"location":"CHANGES/#v0056","title":"[v0.0.56]","text":""},{"location":"CHANGES/#enhancement_22","title":"Enhancement","text":"<ul> <li><code>cphasing-rs</code>, update <code>pairs-intersect</code> and <code>porec-intersect</code></li> <li><code>kprune</code>, remove <code>count_re</code> argument</li> </ul>"},{"location":"CHANGES/#v0055","title":"[v0.0.55]","text":""},{"location":"CHANGES/#new-features_8","title":"New features","text":"<ul> <li><code>hcr_from_contacts</code>, add new function of hcr</li> <li><code>plot_lines</code>, plot lines of evaluation</li> </ul>"},{"location":"CHANGES/#v0054","title":"[v0.0.54]","text":""},{"location":"CHANGES/#bug-fixes_12","title":"Bug fixes","text":"<ul> <li><code>pipeline</code>, fixed bugs</li> </ul>"},{"location":"CHANGES/#v0053","title":"[v0.0.53]","text":""},{"location":"CHANGES/#new-features_9","title":"New features","text":"<ul> <li><code>pipeline</code>, add a pipeline of C-Phasing</li> </ul>"},{"location":"CHANGES/#enhancement_23","title":"Enhancement","text":"<ul> <li><code>prepare</code>, restruct </li> <li><code>pairs2cool</code>, move to second command</li> </ul>"},{"location":"CHANGES/#v0052","title":"[v0.0.52]","text":""},{"location":"CHANGES/#enhancement_24","title":"Enhancement","text":"<ul> <li><code>kprune</code>, load data into tempfile to decrease the memory usage.</li> </ul>"},{"location":"CHANGES/#v0051","title":"[v0.0.51]","text":"<ul> <li>2023-11-11</li> </ul>"},{"location":"CHANGES/#new-features_10","title":"New features","text":"<ul> <li><code>agp</code>, add <code>pseudo-agp</code>, create a pseudo agp from simulation contigs</li> </ul>"},{"location":"CHANGES/#bug-fixed","title":"Bug fixed","text":"<ul> <li><code>hyperpartition</code>, add <code>cross_allelic_factor</code></li> </ul>"},{"location":"CHANGES/#v0050","title":"[v0.0.50]","text":"<ul> <li>2023-11-10</li> </ul>"},{"location":"CHANGES/#enhancement_25","title":"Enhancement","text":"<ul> <li><code>kprune</code>, add multiprocessing</li> </ul>"},{"location":"CHANGES/#v0049","title":"[v0.0.49]","text":"<ul> <li>2023-11-10</li> </ul>"},{"location":"CHANGES/#enhancement_26","title":"Enhancement","text":"<ul> <li><code>cphasing-rs</code>, update it into v0.0.10</li> </ul>"},{"location":"CHANGES/#new-features_11","title":"New features","text":"<ul> <li><code>porec2csv</code>, import porec table into pao csv</li> <li><code>PoreCTable.binnify</code>, binnify the contig by binsize</li> <li><code>PoreCTable.divide_contig_by_nparts</code>, divide contig by the number of parts</li> </ul>"},{"location":"CHANGES/#bug-fixed_1","title":"Bug fixed","text":"<ul> <li><code>hyperpartition</code>, fixed bug that phasing mode report error when the prune table not apply</li> </ul>"},{"location":"CHANGES/#v0048","title":"[v0.0.48]","text":"<ul> <li>2023-11-05</li> </ul>"},{"location":"CHANGES/#enhancement_27","title":"Enhancement","text":"<ul> <li><code>kprune</code>, advanced it to identity more cross-allelic </li> </ul>"},{"location":"CHANGES/#new-features_12","title":"New features","text":"<ul> <li><code>evaluate_prune.py</code>, evaluate the result of <code>kprune</code></li> <li><code>methalign/pipe</code>, init the pipeline of methalign</li> </ul>"},{"location":"CHANGES/#v0047","title":"[v0.0.47]","text":"<ul> <li>2023-10-15</li> </ul>"},{"location":"CHANGES/#enhancement_28","title":"Enhancement","text":"<ul> <li><code>higig</code>, mv <code>ontig</code> to <code>hitig</code>.</li> </ul>"},{"location":"CHANGES/#v0046","title":"[v0.0.46]","text":""},{"location":"CHANGES/#enhancement_29","title":"Enhancement","text":"<ul> <li><code>hcr</code>, add <code>break_pos</code> to correct hcr by break positions</li> </ul>"},{"location":"CHANGES/#bug-fixed_2","title":"Bug fixed","text":"<ul> <li><code>mapper</code>, fixed min_quality can not be adopt</li> </ul>"},{"location":"CHANGES/#v0045","title":"[v0.0.45]","text":""},{"location":"CHANGES/#enhancement_30","title":"Enhancement","text":"<ul> <li><code>hcr</code>, intergated <code>bed2depth</code> into <code>hcr</code></li> </ul>"},{"location":"CHANGES/#bug-fixed_3","title":"Bug fixed","text":"<ul> <li><code>bed2depth</code>, fixed bug</li> </ul>"},{"location":"CHANGES/#v0044","title":"[v0.0.44]","text":""},{"location":"CHANGES/#enhancement_31","title":"Enhancement","text":"<ul> <li><code>ontig</code>, restruct the framework and add <code>split-reads</code>, <code>find-chimeric</code>, <code>hcr</code> three functions.</li> </ul>"},{"location":"CHANGES/#v0043-2023-09-24","title":"[v0.0.43] - 2023-09-24","text":""},{"location":"CHANGES/#new-features_13","title":"New features","text":"<ul> <li><code>methalign</code>, init</li> </ul>"},{"location":"CHANGES/#enhancement_32","title":"Enhancement","text":"<ul> <li>rename <code>ultra_long</code> to <code>ontig</code></li> </ul>"},{"location":"CHANGES/#v0042-2023-09-22","title":"[v0.0.42] - 2023-09-22","text":""},{"location":"CHANGES/#enhancement_33","title":"Enhancement","text":"<ul> <li><code>ultra_long</code>, expose ultra_long tutorial to C-Phasing README.md</li> </ul>"},{"location":"CHANGES/#v0041-2023-08-25","title":"[v0.0.41] - 2023-08-25","text":""},{"location":"CHANGES/#bug-fixed_4","title":"Bug fixed","text":"<ul> <li><code>scaffolding</code>, fixed cp groups.agp error when change the name of agp</li> </ul>"},{"location":"CHANGES/#v0040","title":"[v0.0.40]","text":"<ul> <li>2023-08-19</li> </ul>"},{"location":"CHANGES/#enhancement_34","title":"Enhancement","text":"<ul> <li>add <code>pyproject.toml</code></li> </ul>"},{"location":"CHANGES/#bug-fixed_5","title":"Bug fixed","text":"<ul> <li><code>setup.py</code>, fixed the setup_helper error.</li> </ul>"},{"location":"CHANGES/#v0039","title":"[v0.0.39]","text":""},{"location":"CHANGES/#enhancement_35","title":"Enhancement","text":"<ul> <li>before this version <code>cphasing-rs</code> can not found</li> </ul>"},{"location":"CHANGES/#v0038","title":"[v0.0.38]","text":"<ul> <li>2023-08-18</li> </ul>"},{"location":"CHANGES/#bug-fixed_6","title":"Bug fixed","text":"<ul> <li><code>build</code>, fixed bug that can not specify the output of agp</li> <li><code>scaffolding</code>, fixed bug that can not specify the output of agp</li> </ul>"},{"location":"CHANGES/#v0037","title":"[v0.0.37]","text":"<ul> <li>2023-08-16</li> </ul>"},{"location":"CHANGES/#enhancement_36","title":"Enhancement","text":"<ul> <li><code>README.md</code>, add detail describtions</li> <li><code>scaffolding</code>, directly output <code>groups.agp</code></li> </ul>"},{"location":"CHANGES/#bug-fixed_7","title":"Bug fixed","text":"<ul> <li>fixed bug that resulted some misassembly from v0.0.17</li> </ul>"},{"location":"CHANGES/#v0036","title":"[v0.0.36]","text":"<ul> <li>2023-08-14</li> </ul>"},{"location":"CHANGES/#bug-fixed_8","title":"Bug fixed","text":"<ul> <li><code>hyperpartition</code>     - fixed bug from v0.0.35 that default run ultra-complex mode     - fixed bug that whitelist can not used in single partition</li> <li><code>recluster</code>     - fixed bug of <code>KeyError</code></li> </ul>"},{"location":"CHANGES/#v0035","title":"[v0.0.35]","text":"<ul> <li>2023-08-12</li> </ul>"},{"location":"CHANGES/#enhancement_37","title":"Enhancement","text":"<ul> <li><code>pairs2cool</code>, add <code>--fofn</code> parameter</li> <li><code>hyperpartition</code>, mask <code>ultra-complex</code> parameter</li> </ul>"},{"location":"CHANGES/#v0034","title":"[v0.0.34]","text":"<ul> <li>2023-08-11</li> </ul>"},{"location":"CHANGES/#enhancement_38","title":"Enhancement","text":"<ul> <li><code>mapper</code>, compress hic mapper result</li> <li><code>hyperpartition</code>, add contig filter when import first cluster result</li> <li>2023-08-04</li> </ul>"},{"location":"CHANGES/#bug-fixed_9","title":"Bug fixed","text":"<ul> <li><code>hypergraph</code>, fixed the column index error</li> </ul>"},{"location":"CHANGES/#v0032","title":"[v0.0.32]","text":"<ul> <li>2023-08-04</li> </ul>"},{"location":"CHANGES/#bug-fixed_10","title":"Bug fixed","text":"<ul> <li><code>hypergraph</code>, fixed it can not parse single porec table </li> </ul>"},{"location":"CHANGES/#v0031","title":"[v0.0.31]","text":"<ul> <li>2023-08-02</li> </ul>"},{"location":"CHANGES/#new-features_14","title":"New features","text":"<ul> <li><code>ultra_long</code>, add v1 pipeline</li> </ul>"},{"location":"CHANGES/#v0030","title":"[v0.0.30]","text":"<ul> <li>2023-08-02</li> </ul>"},{"location":"CHANGES/#enhancement_39","title":"Enhancement","text":"<ul> <li><code>hypergraph</code>, speed up</li> </ul>"},{"location":"CHANGES/#bug-fixed_11","title":"Bug fixed","text":"<ul> <li><code>porec-intersection</code>, fixed it can not output result</li> </ul>"},{"location":"CHANGES/#v0029","title":"[v0.0.29]","text":"<ul> <li>2023-07-31</li> </ul>"},{"location":"CHANGES/#bug-fixed_12","title":"Bug fixed","text":"<ul> <li><code>hyperpartition</code>, fixed key word of <code>edges</code> not yet change to <code>hypergraph</code></li> </ul>"},{"location":"CHANGES/#v0028","title":"[v0.0.28]","text":"<ul> <li>2023-07-29</li> </ul>"},{"location":"CHANGES/#new-features_15","title":"New features","text":"<ul> <li><code>collapse</code>, create a collapse rescued contact matrix</li> </ul>"},{"location":"CHANGES/#enhancement_40","title":"Enhancement","text":"<ul> <li>update <code>environment.yml</code></li> <li>update <code>cphasing-rs</code>, which reduce the size of binary and update to <code>v0.0.4</code></li> </ul>"},{"location":"CHANGES/#bug-fixed_13","title":"Bug fixed","text":"<ul> <li><code>scaffolding</code>, fixed path error</li> </ul>"},{"location":"CHANGES/#v0027","title":"[v0.0.27]","text":"<ul> <li>2023-07-14</li> </ul>"},{"location":"CHANGES/#enhancement_41","title":"Enhancement","text":"<ul> <li>remove <code>check_allhic_version</code></li> </ul>"},{"location":"CHANGES/#v0026","title":"[v0.0.26]","text":"<ul> <li>2023-07-12</li> </ul>"},{"location":"CHANGES/#new-features_16","title":"New features","text":"<ul> <li><code>statcluster</code>, stat the clustertable</li> <li><code>plot_hist</code>, plot the distribution of somethings</li> </ul>"},{"location":"CHANGES/#enhancement_42","title":"Enhancement","text":"<ul> <li><code>hypergraph</code>, add prune allelic hyperedges</li> <li><code>statagp</code>, change <code>agpstat</code> to <code>statagp</code></li> <li>change <code>extract</code> to <code>hypergraph</code></li> <li>change <code>optimize</code> to <code>scaffolding</code></li> <li><code>hyperpartition</code>, out \"Chr??g?\" as chromosome name</li> </ul>"},{"location":"CHANGES/#bug-fixed_14","title":"Bug fixed","text":"<ul> <li><code>hyprpartition</code>, not add <code>-pt</code> or <code>at</code>, the <code>-inc</code> not work</li> </ul>"},{"location":"CHANGES/#v0025","title":"[v0.0.25]","text":"<ul> <li>2023-07-05</li> </ul>"},{"location":"CHANGES/#new-features_17","title":"New features","text":"<ul> <li><code>evalutate_known_assembly.py</code>, evalutate the simulated human genome</li> <li><code>cis_trans_by_contigs.py</code>, calculate the cis and trans contacts by pairs</li> <li><code>logo</code>, add logo</li> </ul>"},{"location":"CHANGES/#enhancement_43","title":"Enhancement","text":"<ul> <li><code>hyperpartition</code>, automatic using the exists first clusters results</li> </ul>"},{"location":"CHANGES/#v0024","title":"[v0.0.24]","text":"<ul> <li>2023-06-20</li> </ul>"},{"location":"CHANGES/#new-features_18","title":"New features","text":"<ul> <li><code>ultra_long</code>, init ultra_long method</li> </ul>"},{"location":"CHANGES/#enhancement_44","title":"Enhancement","text":"<ul> <li><code>mapper</code>, add <code>outprefix</code> prameter</li> </ul>"},{"location":"CHANGES/#v0023","title":"[v0.0.23]","text":"<ul> <li>2023-06-17</li> </ul>"},{"location":"CHANGES/#new-features_19","title":"New features","text":"<ul> <li><code>pictures</code>, add the heatmap of M1</li> </ul>"},{"location":"CHANGES/#enhancement_45","title":"Enhancement","text":"<ul> <li><code>hyperpartition</code>, expose <code>--min-allelic-overlap</code></li> <li><code>kprune</code>, add sort and normalize function</li> </ul>"},{"location":"CHANGES/#v0022","title":"[v0.0.22]","text":"<ul> <li>2023-06-16</li> </ul>"},{"location":"CHANGES/#new-features_20","title":"New features","text":"<ul> <li><code>tmpoptimze</code>, a temp function for order and orientation</li> <li><code>PoreCMapper</code>, based on minimap2 and cphasing-rs</li> </ul>"},{"location":"CHANGES/#enhancement_46","title":"Enhancement","text":"<ul> <li><code>plot</code>, add <code>--no-ticks</code> to remove ticks from picture</li> </ul>"},{"location":"CHANGES/#v0021","title":"[v0.0.21]","text":"<ul> <li>2023-06-12</li> </ul>"},{"location":"CHANGES/#enhancement_47","title":"Enhancement","text":"<ul> <li><code>hyperpartition</code>     - change <code>zero-allelic</code> to <code>allelic-factor</code>     - add <code>merge_cluster</code>     - init <code>ultra_complex</code></li> </ul>"},{"location":"CHANGES/#bug-fixed_15","title":"Bug fixed","text":"<ul> <li><code>plot</code>, enable <code>factor</code> can set to 1</li> </ul>"},{"location":"CHANGES/#v0020","title":"[v0.0.20]","text":"<ul> <li>2023-06-07</li> </ul>"},{"location":"CHANGES/#enhancement_48","title":"Enhancement","text":"<ul> <li><code>AlleleTable</code>, load info</li> <li><code>PartigRecord</code>, output allele table with additional information</li> </ul>"},{"location":"CHANGES/#new-features_21","title":"New features","text":"<ul> <li><code>AlleleInfo</code>, object function of allele table information</li> </ul>"},{"location":"CHANGES/#bug-fixed_16","title":"Bug fixed","text":"<ul> <li><code>HyperPartition</code>, fixed bug of prunt -&gt; prunetable</li> </ul>"},{"location":"CHANGES/#v0019","title":"[v0.0.19]","text":"<ul> <li>2023-06-06</li> </ul>"},{"location":"CHANGES/#enhancement_49","title":"Enhancement","text":"<ul> <li><code>KPruneHyperGraph</code>, speed up</li> <li><code>HyperPartition</code>, add the get_prunetable_KPrune</li> </ul>"},{"location":"CHANGES/#v0018","title":"[v0.0.18]","text":"<ul> <li>2023-06-06</li> </ul>"},{"location":"CHANGES/#enhancement_50","title":"Enhancement","text":"<ul> <li><code>hyperpartition</code>     - <code>min_weight</code>, add a parameter of the graph minimum weight </li> <li><code>IRMM</code>, add a function of the graph filter by minimum weight</li> </ul>"},{"location":"CHANGES/#new-features_22","title":"New features","text":"<ul> <li><code>KPruneHyperGraph</code>, add a function that implement pruning on hypergraph</li> </ul>"},{"location":"CHANGES/#v0017","title":"[v0.0.17]","text":"<ul> <li>2023-06-01</li> </ul>"},{"location":"CHANGES/#enhancement_51","title":"Enhancement","text":"<ul> <li><code>environment.yml</code>, update</li> <li><code>hyperpartition</code>     - add <code>--first-cluster</code> to load exists first cluster results     - expose <code>--zero-allelic</code> parameter     - expose <code>--allelic-similarity</code> parameter</li> <li><code>PoreCTable</code>, change to cphasing-rs porec table</li> </ul>"},{"location":"CHANGES/#new-features_23","title":"New features","text":"<ul> <li><code>docs</code>, add docs</li> <li><code>utils</code>     - <code>extract_matrix</code>, extract matrix by th contig list     - <code>prune_matrix</code>, prune matrix by prune table</li> </ul>"},{"location":"CHANGES/#bug-fixes_13","title":"Bug fixes","text":"<ul> <li><code>merge-matrix</code>, fixed the empty contact in result</li> </ul>"},{"location":"CHANGES/#v0016","title":"[v0.0.16]","text":"<ul> <li>2023-05-05</li> </ul>"},{"location":"CHANGES/#enhancement_52","title":"Enhancement","text":"<ul> <li><code>hyperpartition</code>, add mutual exclusion merge</li> </ul>"},{"location":"CHANGES/#bug-fixes_14","title":"Bug fixes","text":"<ul> <li><code>hyperpartition</code>, fixed the bug that incorrect scaffold length in<code>_incremental_partition</code> </li> </ul>"},{"location":"CHANGES/#v0015","title":"[v0.0.15]","text":"<ul> <li>2023-05-01</li> </ul>"},{"location":"CHANGES/#new-features_24","title":"New features","text":"<ul> <li><code>PruneTable</code>, Object for prune table.</li> </ul>"},{"location":"CHANGES/#enhancement_53","title":"Enhancement","text":"<ul> <li><code>kprune</code>, output prune table</li> <li><code>hyperpartition</code>     - add k parameter to output the specified number groups</li> </ul>"},{"location":"CHANGES/#v0014","title":"[v0.0.14]","text":"<ul> <li>2023-03-22</li> </ul>"},{"location":"CHANGES/#new-features_25","title":"New features","text":"<ul> <li><code>plot_heatmap</code>, custom function to plot heatmap </li> </ul>"},{"location":"CHANGES/#enhancement_54","title":"Enhancement","text":"<ul> <li><code>HyperPartition</code>     - add post check to increase the accuracy of partition     - add min-contacts parameters to remove low contact contig pairs     - add negative allelic algorithm     - change multi to incremental     - add <code>whitelist</code> and <code>blacklist</code> parameters</li> </ul>"},{"location":"CHANGES/#bug-fixes_15","title":"Bug fixes","text":"<ul> <li><code>KPrune</code>, dropna in pixels which will let igraph fall into loops</li> </ul>"},{"location":"CHANGES/#v0013","title":"[v0.0.13]","text":"<ul> <li>2023-03-15</li> </ul>"},{"location":"CHANGES/#new-features_26","title":"New features","text":"<ul> <li><code>KPruner</code>, prune contig contacts according similarity allele table</li> </ul>"},{"location":"CHANGES/#enhancement_55","title":"Enhancement","text":"<ul> <li><code>extract_incidence_matrix</code>, restruct to speed up </li> <li><code>extract</code>, <code>hyperpartition</code>, import contig sizes instead of fasta</li> <li><code>HyperPartition</code>, add filter function of minimum scaffolding length  </li> <li><code>build</code>, add only-agp option</li> </ul>"},{"location":"CHANGES/#bug-fixes_16","title":"Bug fixes","text":"<ul> <li><code>HyperExtractor</code>, fixed the problem of read index for multi dataframe concat</li> </ul>"},{"location":"CHANGES/#v0012","title":"[v0.0.12]","text":"<ul> <li>2023-03-11</li> </ul>"},{"location":"CHANGES/#new-features_27","title":"New features","text":"<ul> <li><code>HyperGraph</code>, instead of hypernetx to speed up </li> <li><code>prepare</code>, a cli function for some preparation for C-Phasing</li> <li><code>optimize.cpp</code>, optimize algorithm v1</li> </ul>"},{"location":"CHANGES/#enhancement_56","title":"Enhancement","text":"<ul> <li><code>HyperEdges</code>, restruct to {idx, row, col}</li> <li><code>Extractor</code> and <code>HyperExtractor</code>, change to export <code>HyperEdges</code> </li> <li><code>process_pore_c_table</code>, speed up</li> <li><code>HyperPartition</code>, use custom <code>HyperGraph</code> to speed up</li> <li><code>merge_matrix</code>, merge binning matrix into whole contigs</li> <li><code>optimize</code>, cli for optimize score cacluation</li> </ul>"},{"location":"CHANGES/#bug-fixes_17","title":"Bug fixes","text":"<ul> <li><code>alleles</code>, fix the bug of empty allele table</li> </ul>"},{"location":"CHANGES/#v0011","title":"[v0.0.11]","text":"<ul> <li>2023-03-08</li> </ul>"},{"location":"CHANGES/#enhancement_57","title":"Enhancement","text":"<ul> <li><code>Extractor</code> and <code>HyperExtractor</code>, change to export dict to list</li> <li><code>HyperPartition</code>, add parallel in hypergraph generation </li> </ul>"},{"location":"CHANGES/#v0010","title":"[v0.0.10]","text":"<ul> <li>2023-03-08</li> </ul>"},{"location":"CHANGES/#new-features_28","title":"New features","text":"<ul> <li><code>Extractor</code>, extract edges from pairs file</li> <li><code>HyperExtractor</code>, extract hyperedges from pore-c table</li> <li><code>HyperEdges</code>, msgspec Struct for hyperedges serialization</li> </ul>"},{"location":"CHANGES/#enhancement_58","title":"Enhancement","text":"<ul> <li><code>HyperPartition</code>, divesting edges extract function to improve usability</li> </ul>"},{"location":"CHANGES/#v009","title":"[v0.0.9]","text":"<ul> <li>2023-01-06 <code>refactor the frame of cphasing that seperating the hic and pore-c pipelines</code></li> </ul>"},{"location":"CHANGES/#new-features_29","title":"New features","text":"<ul> <li><code>agp2assembly</code>, convert agp to assembly file</li> <li><code>pairs2mnd</code>, convert pairs to mnd file</li> <li><code>paf2table</code>, convert paf to table</li> <li><code>pore_c_cchrom2contig</code>, convert chromosome-level to contig-level</li> <li><code>pairs_chrom2contig</code>, convert chromosome-level to contig-level</li> <li><code>optimzie</code>, init add optimize</li> </ul>"},{"location":"CHANGES/#enhancement_59","title":"Enhancement","text":"<ul> <li><code>PAFTable</code>, speed up</li> <li><code>PoreCTable</code>, speed up and add <code>chrom2contig</code></li> <li><code>HyperPartition</code>, speed up the pore-c reads process</li> <li><code>paf2pairs</code>, speed up</li> </ul>"},{"location":"CHANGES/#bug-fixes_18","title":"Bug fixes","text":"<ul> <li><code>plot</code>, to humanized</li> </ul>"},{"location":"CHANGES/#v008","title":"[v0.0.8]","text":"<ul> <li>2022-11-17</li> </ul>"},{"location":"CHANGES/#new-features_30","title":"New features","text":"<ul> <li><code>hypergraph</code>, contain a hypergraph cluster algorithms</li> <li><code>HyperPartition</code>, partition contigs in diploid or allopolyploid</li> <li><code>PartigAllele</code>, enable using sequences similarity to generate allele table</li> <li><code>PAFTable</code>, filter alignment</li> <li><code>PoreCTable</code>, stat alignment information</li> </ul>"},{"location":"CHANGES/#enhancement_60","title":"Enhancement","text":"<ul> <li><code>agp2fasta</code>, <code>build</code>, using dictory instead of faidx to speed up</li> </ul>"},{"location":"CHANGES/#bug-fixes_19","title":"Bug fixes","text":"<ul> <li><code>PairHeader</code>, save header without \"\\n\".</li> <li><code>rescue</code>, fix CountRE only default load &gt;=3.</li> <li><code>plot</code>, fix bug of hicexplorer outputFilename error.</li> </ul>"},{"location":"CHANGES/#v007","title":"[v0.0.7]","text":"<ul> <li>2022-10-31</li> </ul>"},{"location":"CHANGES/#new-features_31","title":"New features","text":"<ul> <li><code>plot</code>, provide adjust matrix and plot matrix function.</li> <li><code>AdapativePartition</code>, partition by adapative pipeline for find best results</li> <li><code>PoreCMapper</code>, Pore-C reads mapping pipeline.</li> <li><code>PAFTable</code>, a function for processing paf file. (include <code>to_pairs</code>)</li> </ul>"},{"location":"CHANGES/#enhancement_61","title":"Enhancement","text":"<ul> <li><code>correct</code>, increase recall and precision to 70%</li> <li><code>pairs</code>, add <code>chrom2contig</code> to convert a chrom-level pairs to contig-level</li> </ul>"},{"location":"CHANGES/#v006","title":"[v0.0.6]","text":"<ul> <li>2022-10-07</li> </ul>"},{"location":"CHANGES/#new-features_32","title":"New features","text":"<ul> <li>Change packages name to CPhasing.</li> <li>New function of      - <code>correct</code>     - <code>alleles</code>     - <code>rescue</code>     - <code>partition</code></li> <li>New API of <code>Pairs</code> in <code>core</code>.</li> </ul>"},{"location":"CHANGES/#bug-fixes_20","title":"Bug fixes","text":"<ul> <li>Using normalized signal in <code>prune</code>.</li> </ul>"},{"location":"basic_usage/","title":"One command pipeline of C-Phasing","text":""},{"location":"basic_usage/#pipeline","title":"Pipeline","text":"<p>The <code>-n 8:4</code> parameter of the following commands means assembling a tetraploid (4) with 8 chromosome basic numbers. If you set <code>-n 0:0</code> means partition in both rounds automatically, also support it set to <code>-n 8:0</code> or <code>-n 0:4</code>.  </p> <p>Note</p> <p><code>CPhasing</code> also support the monoploid scaffolding, when you set one group number, e.g. <code>-n 8</code>. The <code>pipeline</code> will automatically skip the step <code>1.alleles</code>, and only run one round partition.</p> <p>Note</p> <p>If the user's genome is an allopolyploid with low subgenome similarity, the initial grouping may not be optimal. In such cases, users should adjust the -n parameter based on the ploidy and genome structure:</p> <ul> <li>For allotetraploids (2n = 4x = 32), the genome can be treated as a diploid assembly. Use <code>-n 16</code> if you want to assemble two subgenomes, set <code>-n 16:2</code>, if you want to phase the subgenome, respectively. </li> <li> <p>For allohexaploids:</p> <ul> <li>AAABBB type (2n = 6x = 48): use <code>-n 16:3</code>.</li> </ul> <ul> <li>AABBCC type (2n = 6x = 48): use <code>-n 24:2</code>.</li> </ul> </li> </ul>"},{"location":"basic_usage/#start-from-a-pore-c-data","title":"Start from a pore-c data:","text":"<pre><code>cphasing pipeline -f draft.asm.fasta -pcd sample.fastq.gz -t 10 -n 8:4\n</code></pre>"},{"location":"basic_usage/#start-from-multiple-pore-c-data","title":"Start from multiple Pore-C data:","text":"<p>specify multiple <code>-pcd</code> parameters.  <pre><code>cphasing pipeline -f draft.asm.fasta -pcd sample1.fastq.gz -pcd sample2.fastq.gz -t 10 -n 8:4\n</code></pre></p> <p>Note</p> <p>If you want to run on cluster system and submit them to multiple nodes, you can use <code>cphasing mapper</code> and <code>cphasing-rs porec-merge</code> to generate the merged <code>porec.gz</code> file and input it by <code>-pct</code> parameter. Please check the doc:Mapper</p>"},{"location":"basic_usage/#start-from-a-pore-c-table-porecgz","title":"Start from a Pore-C table (<code>.porec.gz</code>):","text":"<p>which is generated by <code>cphasing mapper</code>. <pre><code>cphasing pipeline -f draft.asm.fasta -pct sample.porec.gz -t 10 -n 8:4\n</code></pre></p>"},{"location":"basic_usage/#start-from-hifi-c-data","title":"Start from HiFi-C data","text":"<p>Run <code>pipeline</code> or <code>mapper</code> with <code>--mm2-params \"-x map-hifi\"</code> parameter. And the output similar to the results of pore-c data. <pre><code>cphasing pipeline -f draft.asm.fasta -pcd hific.fastq.gz --mm2-params \"-x map-hifi \"  -t 10 -n 8:4\n</code></pre></p> <p>Note</p> <p>The mapping results of HiFi-C is similar to Pore-C, such as output suffix with <code>porec.gz</code>, and process it use <code>porec-merge</code>, <code>porec-intersect</code>, et al.</p>"},{"location":"basic_usage/#start-from-hi-c-data","title":"Start from Hi-C data","text":"<pre><code>cphasing pipeline -f draft.asm.fasta -hic1 Lib_R1.fastq.gz -hic2 Lib_R2.fastq.gz -t 10 -n 8:4\n</code></pre> <p>Note</p> <ul> <li>1 | If you want to run multiple samples, you can use <code>cphasing hic mapper</code> and <code>cphasing-rs pairs-merge</code> to generate the merged <code>pairs.pqs</code> file, and input it by <code>-prs</code> parameter.  </li> <li>2 | If the total length of your input genome is larger than 8 Gb, the <code>-hic-mapper-k 27 -hic-mapper-w 14</code> should be specified, to avoid the error of <code>chromap</code>. </li> </ul>"},{"location":"basic_usage/#start-from-4dn-pairs-pairspqs-or-pairsgz-file","title":"Start from 4DN pairs (<code>pairs.pqs</code> or <code>pairs.gz</code>) file","text":"<code>pairs.pqs</code><code>pairs.gz</code> <pre><code>cphasing pipeline -f draft.asm.fasta -prs sample.pairs.pqs -t 10 -n 8:4\n</code></pre> <pre><code>cphasing pipeline -f draft.asm.fasta -prs sample.pairs.gz -t 10 -n 8:4\n</code></pre>"},{"location":"basic_usage/#skip-some-steps","title":"Skip some steps","text":"<pre><code>## skip steps 1.alleles and 2.prepare steps \ncphasing pipeline -f draft.asm.fasta -pct sample.porec.gz -t 10 -ss 1,2\n</code></pre>"},{"location":"basic_usage/#perform-only-specified-steps","title":"Perform only specified steps","text":"<pre><code>## run 3.hyperpartition \ncphasing pipeline -f draft.asm.fasta -pct sample.porec.gz -t 10 -s 3\n</code></pre>"},{"location":"basic_usage/#improve-performance","title":"Improve performance","text":"<p>Add the <code>-hcr</code> parameter to remove the greedy contacts (several regions contact with the whole genome) to improve the phasing quality. And specified <code>-p AAGCTT</code> to normalize the depth calculation to avoid biased of RE's distribution, which <code>AAGCTT</code> is the pattern of restriction enzyme.  <pre><code>cphasing pipeline -f draft.asm.fasta -pct sample.porec.gz -t 10 -hcr -p AAGCTT\n</code></pre></p>"},{"location":"basic_usage/#curation-by-juicebox","title":"Curation by Juicebox","text":"<ul> <li>generate <code>.assembly</code> and <code>.hic</code>, depend on 3d-dna </li> </ul> <pre><code>cphasing pairs2mnd sample.pairs.gz -o sample.mnd.txt\ncphasing utils agp2assembly groups.agp &gt; groups.assembly\nbash ~/software/3d-dna/visualize/run-assembly-visualizer.sh sample.assembly sample.mnd.txt\n</code></pre> <p>Note</p> <p>if chimeric corrected, please use <code>groups.corrected.agp</code> and generate a new <code>corrected.pairs.pqs</code> by <code>cphasing-rs pairs-break</code> </p> <ul> <li>After curation <pre><code>## convert assembly to agp\ncphasing utils assembly2agp groups.review.assembly -n 8:4 \n## or haploid or a homologous group\ncphasing utils assembly2agp groups.review.assembly -n 8\n## extract contigs from agp \ncphasing agp2fasta groups.review.agp draft.asm.fasta --contigs &gt; contigs.fasta\n## extract chromosome-level fasta from agp\ncphasing agp2fasta groups.review.agp draft.asm.fasta &gt; groups.review.asm.fasta\n</code></pre></li> </ul>"},{"location":"basic_usage/#rename","title":"Rename","text":"<p>Rename and orient chromosome according a monoploid reference (or genome of closely related species).  More details please check Rename <pre><code>cphasing rename -r mono.fasta -f draft.asm.fasta -a groups.review.agp -t 20\n</code></pre></p> <p>Note</p> <p>To reduce the time consumed, we only align the first haplotype (g1) to the monoploid, which the orientation among different haplotypes has already been set to the same in the <code>scaffolding</code> step. If not, you can set <code>\u2014-unphased</code> to align all haplotypes to the monoploid to adjust the orientation.  </p>"},{"location":"basic_usage/#heatmap-plotting","title":"Heatmap plotting","text":"<p>Please check the doc: Plot</p>"},{"location":"faq/","title":"FAQ","text":""},{"location":"faq/#the-results-of-the-first-round-partition-are-unsatisfactory","title":"The results of the first round partition are unsatisfactory.","text":"<p>In our two-round partition algorithm, the first round partition depends on the h-trans errors between homologous chromosomes; if you input a contig assembly with low level switch errors or input a high accuracy pore-c data, the h-trans will be not enough to cluster all contigs to correct homologous groups, resulting in unsatisfactory results. You can set the <code>-q1 0</code> for <code>hyperpartition</code> to increase the rate of h-trans errors. However, this parameter may raise error of <code>out of memory</code> when you input huge pore-c data in porec table or hic contacts in pairs file. </p>"},{"location":"faq/#the-total-size-of-the-chromosomes-significantly-smaller-than-the-estimate-genome-size","title":"The total size of the chromosomes significantly smaller than the estimate genome size","text":"<p>If the following two conditions exist, you can adjust the mode of the <code>cphasing pipeline</code> to either (<code>--preset sensitive</code>) or (<code>--preset very-sensitive</code>).  1. The amount of entered data is low. 2. The input genome is relatively complex, with many homozygous or nearly homozygous regions. It should be noted that the above two modes will cause some very small contig to cluster or sort incorrectly. In the second case, greedy clustering may occurs, in which two highly homologous sets of chromosomes are grouped into one group.</p>"},{"location":"faq/#how-to-set-the-n-parameter-when-assembling-an-aneuploid-genome","title":"How to set the <code>-n</code> parameter when assembling an aneuploid genome.","text":"<p>The aneuploid genome, such as modern cultivated sugarcane, contains unequal homologous chromosomes. The <code>-n</code> parameter can be set to zero (<code>-n 10:0</code>) to automatically partition contigs into different chromosomes within a homologous group.    However, we also allow the user to input a file with two columns: the first column is the index(1-base) of the first round partition, and the second column is the chromosome number of each homologous. And then specified the <code>-n 10:second.number.tsv</code> in <code>cphasing pipeline</code> or <code>cphasing hyperpartition</code>. - <code>second.number.tsv</code> <pre><code>1    13\n2    12\n3    12\n4    11\n5    10\n6    12\n7    12\n8    10\n9    12\n10    12\n</code></pre></p>"},{"location":"CLI/alleles/","title":"Alleles","text":"<p>Alleles aims to identify the allelic contig pairs by pairwise comparison.</p>"},{"location":"CLI/alleles/#examples","title":"Examples","text":""},{"location":"CLI/alleles/#total-length-of-genome-10-gb","title":"Total length of genome &lt; 10 Gb","text":"<pre><code>cphasing alleles -f draft.asm.fasta\n</code></pre>"},{"location":"CLI/alleles/#total-length-of-genome-10-gb_1","title":"Total length of genome &gt;= 10 Gb","text":"<pre><code>cphasing alleles -f draft.asm.fasta -k 27 -w 14\n</code></pre>"},{"location":"CLI/alleles/#parameters","title":"Parameters","text":"cphasing alleles -h<pre><code> Usage: cphasing alleles [OPTIONS]                                              \n\n Build allele table by kmer similarity.                                         \n\n\u256d\u2500 Options \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 *  --fasta    -f        polyploid contig-level fasta.                        \u2502\n\u2502                         (FILE)                                               \u2502\n\u2502                         [required]                                           \u2502\n\u2502    --output   -o        path of output allele table [default:                \u2502\n\u2502                         fasta_prefix.allele.table]                           \u2502\n\u2502                         (PATH)                                               \u2502\n\u2502               -k        kmer size for similarity calculation.                \u2502\n\u2502                         (INT)                                                \u2502\n\u2502                         [default: 19]                                        \u2502\n\u2502               -w        minimizer window size for similarity calculation.    \u2502\n\u2502                         (INT)                                                \u2502\n\u2502                         [default: 19]                                        \u2502\n\u2502               -c        max occurance of allelic pairs                       \u2502\n\u2502                         (INT)                                                \u2502\n\u2502                         [default: 60]                                        \u2502\n\u2502               -n        minimum chain end                                    \u2502\n\u2502                         (INT)                                                \u2502\n\u2502                         [default: 5]                                         \u2502\n\u2502               -m        minimum k-mer similarity for similarity calculation. \u2502\n\u2502                         (FLOAT)                                              \u2502\n\u2502                         [default: 0.5; 0&lt;=x&lt;=1]                              \u2502\n\u2502               -d        minimum different threshold between contig pairs.    \u2502\n\u2502                         (FLOAT RANGE)                                        \u2502\n\u2502                         [default: 0.1; 0&lt;=x&lt;=1]                              \u2502\n\u2502    --threads  -t        Number of threads.                                   \u2502\n\u2502                         (INT)                                                \u2502\n\u2502                         [default: 4]                                         \u2502\n\u2502    --help     -h,-help  Show this message and exit.                          \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n</code></pre>"},{"location":"CLI/collapse/","title":"Collapse","text":"<p>Collapsed contigs are commonly observed in polyploid hybrids due to the presence of highly similar homologous regions introduced through hybridization. These regions pose significant challenges for direct de novo assembly using current computational approaches (e.g. hifiasm). To address this limitation, we developed a strategy comprising two steps:    (1) Collapsed contigs detection: Identification of candidate contigs (copy number \u22652) through integrated analysis of sequencing depth profiles from HiFi, ONT, and Pore-C data.   (2) Collapsed contigs rescuing: Duplicating and putting collapsed contigs into correctly groups.</p> <p>Warning</p> <p>This methodology\u2019s particular efficacy in resolving localized collapsed regions can not resolve the collapsed regions that nearly whole chromosomes.</p>"},{"location":"CLI/collapse/#collapsed-contigs-detection","title":"Collapsed contigs detection","text":"HiFi dataONT dataPore-C dataGFA <ul> <li>Custom mapping <pre><code>minimap2 -cx map-hifi -I 16g --secondary=no -t 40 draft.asm.fasta hifi.fastq.gz | pigz -p 10 -c &gt; hifi.align.paf.gz\n\ncphasing-rs paf2depth hifi.align.paf.gz -w 5000 -s 1000 -o hifi.align.depth\ncphasing collapse from-depth hifi.align.depth\n</code></pre></li> </ul> <ul> <li>Directly use the hitig results   <code>output.collapsed.contigs.list</code></li> </ul> <ul> <li>Custom mapping   <pre><code>minimap2 -cx map-ont -I 16g -t 40 --secondary=no draft.asm.fasta ont.fastq.gz | pigz -p 10 -c &gt; ont.align.paf.gz\n\ncphasing-rs paf2depth hifi.align.paf.gz -w 5000 -s 1000 -o ont.align.depth\ncphasing collapse from-depth ont.align.depth\n</code></pre></li> <li>Directly use the hitig results   <code>output.collapsed.contigs.list</code></li> </ul> <p>The <code>porec.align.paf.gz</code> generated from <code>cphasing mapper</code>. <pre><code>cphasing-rs paf2depth porec.align.paf.gz -w 5000 -s 1000 -o porec.align.depth\ncphasing collapse from-depth porec.align.depth\n</code></pre></p> <p>The GFA file generated from <code>hifiasm</code> record the read number, which can be used to identify the collapsed contigs. <pre><code>cphasing collapse from-gfa hifi.p_utg.noseq.gfa.gz \n</code></pre></p>"},{"location":"CLI/collapse/#collapsed-contigs-rescuing","title":"Collapsed contigs rescuing","text":"<pre><code>    cphasing collapse rescue 3.hyperpartition/porec.align.porec.q1.e5m.hg draft.asm.contigsizes 3.hyperpartition/output.clusters.txt contigs.collapsed.contig.list -n 4 -at 3.hyperpartition/draft.asm.allele.table\n</code></pre> <p>Note</p> <p>Currently, we output the rescue result into a <code>collapsed.rescue.clusters.txt</code> file, which the user executes the next step of <code>4.scaffolding</code> manually. And the input file can directly use the previous.</p>"},{"location":"CLI/collapse/#after-scaffolding","title":"After scaffolding","text":"<ul> <li>Generate new contig-level fasta and agp, which renamed the duplicated contigs (e.g. utg000001l -&gt; utg000001_d2) The name of collapsed contigs in agp is need to rename for subsequence processes. <pre><code>cphasing agp2fasta groups.rescued.agp draft.asm.fasta --contigs &gt; draft.dup.fasta\ncphasing collapse agp-dup groups.rescued.agp &gt; groups.dup.agp\n</code></pre></li> </ul> <ul> <li>Generate a new <code>pairs.gz</code> or <code>pairs.pqs</code> file  <pre><code>cphasing collapse pairs-dup sample.pairs.pqs collapsed.rescue.contigs.list -o sample.dup.pairs.pqs \n</code></pre></li> </ul> <ul> <li>Curation by juicebox <pre><code>cphasing utils agp2assembly groups.dup.agp &gt; groups.dup.assembly\ncphasing pairs2mnd sample.dup.pairs.pqs -o sample.dup.mnd.txt\n</code></pre></li> </ul> <ul> <li>Rename <pre><code>cphasing rename -r ref.fa -f draft.dup.fasta -a groups.dup.agp -t 40 \n</code></pre></li> </ul> <ul> <li>Plot <pre><code>cphasing pairs2cool sample.dup.pairs.pqs sample.dup.pairs.pqs/_contigsizes sample.10k.cool \ncphasing plot -a groups.dup.agp -m sample.10k.cool -o sample.500k.wg.png \n</code></pre></li> </ul>"},{"location":"CLI/hic_mapper/","title":"HiC Mapper","text":""},{"location":"CLI/hic_mapper/#one-cell","title":"one cell","text":"<pre><code>cphasing hic mapper -f draft.asm.fasta -1 hic_R1.fastq.gz -2 hic_R2.fastq.gz -t 40\n</code></pre> <p>Note</p> <p>If the total length of your input genome is larger than 8 Gb, the <code>-k 27 -w 14</code> should be specified, to avoid the error of <code>chromap</code>. </p>"},{"location":"CLI/hic_mapper/#mutiple-cells","title":"mutiple cells","text":""},{"location":"CLI/hic_mapper/#submit-each-cell-to-the-cluster","title":"Submit each cell to the cluster","text":"<ul> <li>use multiple scripts to run mapper for each sample run_sample1.sh<pre><code>cphasing hic mapper -f draft.asm.fasta -1 hic-1_R1.fastq.gz -2 hic-1_R2.fastq.gz -t 40\n</code></pre>run_sample2.sh<pre><code>cphasing hic mapper -f draft.asm.fasta -1 hic-2_R1.fastq.gz -2 hic-2_R2.fastq.gz -t 40\n</code></pre> run_sample3.sh<pre><code>cphasing hic mapper -f draft.asm.fasta -1 hic-3_R1.fastq.gz -2 hic-3_R2.fastq.gz -t 40\n</code></pre> </li> </ul> <p>Note</p> <p>Please submit one first; wait until the index is successfully created and the remaining jobs are enabled to submit to the cluster.</p> <ul> <li>merge results <pre><code>cphasing pairs-merge hic-*.pairs.pqs -o hic.merge.pairs.pqs\n</code></pre></li> </ul>"},{"location":"CLI/hic_mapper/#parameters","title":"Parameters","text":"<pre><code> Usage: cphasing hic mapper [OPTIONS]                                                             \n\n Mapper for reads mapping.                                                                        \n\n\u256d\u2500 Options \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 *  --fasta,--reference  -f,-r     Path of reference fasta file.                                \u2502\n\u2502                                   (FILE)                                                       \u2502\n\u2502                                   [required]                                                   \u2502\n\u2502 *  --read1              -1        Path of read 1.                                              \u2502\n\u2502                                   (FILE)                                                       \u2502\n\u2502                                   [required]                                                   \u2502\n\u2502 *  --read2              -2        Path of read 2.                                              \u2502\n\u2502                                   (FILE)                                                       \u2502\n\u2502                                   [required]                                                   \u2502\n\u2502                         -k        kmer size for mapping.                                       \u2502\n\u2502                                   (INT)                                                        \u2502\n\u2502                                   [default: 17]                                                \u2502\n\u2502                         -w        minimizer window size for mapping.                           \u2502\n\u2502                                   (INT)                                                        \u2502\n\u2502                                   [default: 7]                                                 \u2502\n\u2502    --mapq               -q        Minimum quality of mapping [0, 60].                          \u2502\n\u2502                                   (INT)                                                        \u2502\n\u2502                                   [default: 0; 0&lt;=x&lt;=60]                                       \u2502\n\u2502    --aligner            -a        Aligner executable. _chromap is the modifed version in       \u2502\n\u2502                                   C-Phasing, if you want to use the offical version you can    \u2502\n\u2502                                   set aligner to chromap                                       \u2502\n\u2502                                   (_chromap|chromap)                                           \u2502\n\u2502                                   [default: _chromap]                                          \u2502\n\u2502    --threads            -t        Number of threads.                                           \u2502\n\u2502                                   (INT)                                                        \u2502\n\u2502                                   [default: 4]                                                 \u2502\n\u2502    --help               -h,-help  Show this message and exit.                                  \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n</code></pre>"},{"location":"CLI/mapper/","title":"Mapper","text":"<p><code>cphasing mapper</code> is designed for process Pore-C or HiFi-C data, its output two files:     (1) porec table (<code>.porec.gz</code>) which contain high-order contacts    (2) 4DN pairs (<code>.pairs.pqs</code>) which only retain VPCs.</p> <p>Note</p> <p>The output of HiFi-C, still named <code>.porec.gz</code>, contains the same results whether Pore-C or HiFi-C data.</p>"},{"location":"CLI/mapper/#examples","title":"Examples","text":""},{"location":"CLI/mapper/#process-one-cell-pore-c-data","title":"Process one cell Pore-C data","text":"<pre><code>cphasing mapper draft.contigs.fasta sample.porec.fastq.gz -t 40 \n</code></pre>"},{"location":"CLI/mapper/#process-multiple-cells-pore-c-data","title":"Process multiple cells Pore-C data","text":""},{"location":"CLI/mapper/#process-together","title":"Process together","text":"<p><pre><code>cphasing mapper draft.contigs.fasta sample1.porec.fastq.gz sample2.porec.fastq.gz -t 40 \n</code></pre> or  <pre><code>cphasing mapper draft.contigs.fasta sample*.porec.fastq.gz -t 40 \n</code></pre></p> <p>Note</p> <p>It will output results using the <code>sample1.porec</code> as the prefix</p>"},{"location":"CLI/mapper/#submit-each-cell-to-the-cluster","title":"Submit each cell to the cluster","text":"<ul> <li>use multiple scripts to run mapper for each sample run_sample1.sh<pre><code>cphasing mapper draft.contigs.fasta sample1.porec.fastq.gz -t 40\n</code></pre> run_sample2.sh<pre><code>cphasing mapper draft.contigs.fasta sample2.porec.fastq.gz -t 40\n</code></pre> run_sample3.sh<pre><code>cphasing mapper draft.contigs.fasta sample3.porec.fastq.gz -t 40\n</code></pre></li> </ul> <ul> <li>merge results  <pre><code>cphasing porec-merge sample1.porec.porec.gz sample2.porec.porec.gz sample3.porec.porec.gz -o sample.merge.porec.gz\ncphasing pairs-merge sample1.porec.pairs.pqs sample2.porec.pairs.pqs sample3.porec.pairs.pqs -o sample.merge.pairs.pqs\n</code></pre></li> </ul>"},{"location":"CLI/mapper/#process-one-cell-hifi-c-data","title":"Process one cell HiFi-C data","text":"<pre><code>cphasing mapper draft.contigs.fasta sample.porec.fastq.gz -t 40 --mm2-params \"-x map-hifi\"\n</code></pre>"},{"location":"CLI/mapper/#process-multiple-cells-hifi-c-data","title":"Process multiple cells HiFi-C data","text":"<p>All the steps of this same with processing in the Pore-C data, with the parameter of <code>--mm2-params \"-x map-hifi\"</code>.</p>"},{"location":"CLI/mapper/#parameters","title":"Parameters","text":"cphasing mapper -h<pre><code> Usage: cphasing mapper [OPTIONS] REFERENCE FASTQ...   \n\n Mapper for pore-c reads.                                                  \n REFERENCE: Path of reference                                              \n\n FASTQ: Path of pore-c reads, multiple file enabled, the prefix of output  \n default only use sample 1.                                                \n\n\u256d\u2500 Arguments \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 *  REFERENCE    (PATH) [required]                                       \u2502\n\u2502 *  FASTQ        (PATH) [required]                                       \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n\u256d\u2500 Options \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 --enzyme        -e        Restrict site pattern, use comma to separate  \u2502\n\u2502                           multiple patterns.                            \u2502\n\u2502                           (STR)                                         \u2502\n\u2502 --mm2-params              additional parameters for minimap2            \u2502\n\u2502                           (STR)                                         \u2502\n\u2502                           [default: -x map-ont]                         \u2502\n\u2502 --mapq          -q        Minimum quality of mapping [0, 60].           \u2502\n\u2502                           (INT)                                         \u2502\n\u2502                           [default: 0; 0&lt;=x&lt;=60]                        \u2502\n\u2502 --min-identity  -p        Minimum percentage identity of alignments [0, \u2502\n\u2502                           1.0].                                         \u2502\n\u2502                           (FLOAT)                                       \u2502\n\u2502                           [default: 0.8; 0.0&lt;=x&lt;=1.0]                   \u2502\n\u2502 --min-length    -l        Minimum length of fragments.                  \u2502\n\u2502                           (INT)                                         \u2502\n\u2502                           [default: 150]                                \u2502\n\u2502 --max-edge      -me       Maximum length of fragment located in the     \u2502\n\u2502                           edge of contigs.                              \u2502\n\u2502                           (INT)                                         \u2502\n\u2502                           [default: 2000]                               \u2502\n\u2502 --force         -f        Force run all the command, ignore existing    \u2502\n\u2502                           results. The index file also will be removed. \u2502\n\u2502 --outprefix     -o        output prefix, if none use the prefix of      \u2502\n\u2502                           fastq                                         \u2502\n\u2502                           (TEXT)                                        \u2502\n\u2502 --threads       -t        Number of threads.                            \u2502\n\u2502                           (INT)                                         \u2502\n\u2502                           [default: 4]                                  \u2502\n\u2502 --help          -h,-help  Show this message and exit.                   \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n</code></pre>"},{"location":"CLI/methalign/","title":"Methalign","text":"<p>To improve mapping accuracy by utilizing information from allele-specific 5mC sites, we developed a module called <code>Methalign</code>. This module comprises a pipeline for correcting alignments by the fifth base (5mCG). This module is designed for ultra-complex polyploids, which contain many high-similarity homologous regions and are hard to partition (unstable).</p> <p>Info</p> <p>If you want to process Pore-C/HiFi-C data without 5mC information, please use the Mapper</p> <p>Note</p> <p>The input bam should contain the <code>MM/ML</code> tags</p>"},{"location":"CLI/methalign/#activate-the-environment-of-methalign","title":"Activate the environment of methalign","text":"<pre><code>source activate_cphasing methalign\n</code></pre> <p>Info</p> <p>The network should be accessible if the methalign environment is first activated.</p>"},{"location":"CLI/methalign/#calculate-the-5mcg-sites-of-contig-assembly","title":"Calculate the 5mCG sites of contig assembly","text":"HiFi readsONT reads <p>Align the HiFi reads by pbmm2</p> <pre><code>pbmm2 index --preset CCS contigs.fasta index.mmi \npbmm2 align --preset CCS index.mmi HiFi_reads.bam | samtools view - -b -o HiFi.align.bam\nsamtools sort HiFi.align.bam -o HiFi.align.sorted.bam\nsamtools index HiFi.align.sorted.bam\n</code></pre> <p>Calculate the 5mC sites by pb-cpg-tools <pre><code>aligned_bam_to_cpg_scores --bam HiFi.align.sorted.bam --ref contigs.fasta --model pileup_calling_model.v1.tflite --modsites-mode reference\nawk '{print $1,$2,$3,$9}' OFS='\\t' HiFi_align_sorted_bam_to_cpg_scores.combined.bed &gt; output.methyl.bg\n</code></pre></p> <p>Align the ONT reads by dorado</p> <pre><code>dorado aligner contigs.fasta ont_reads.bam -t 20 | samtools view -q 1 -@ 10 -b | samtools sort -@ 10 &gt; ont.align.sorted.bam \nsamtools index ont.align.sorted.bam \n</code></pre> <p>Calculate the 5mC sites by modkit</p> <pre><code>modkit pileup ont.align.sorted.bam output.methyl.bed --log-filepath pileup.log --cpg --ref contigs.fasta -t 60 --combine-strands\nawk '{print $1,$2,$3,$11}' OFS='\\t' output.methyl.bed &gt; output.methyl.bg\n</code></pre>"},{"location":"CLI/methalign/#align-the-candidate-reads-to-contig-assembly","title":"Align the candidate reads to contig assembly","text":"<pre><code>dorado aligner contigs.fasta porec_reads.bam --secondary=yes &gt; porec.align.bam\n</code></pre> <p>Note</p> <p>Replace <code>--secondary=yes</code> to <code>--mm2-opts \"--secondary=yes\"</code> when using dorado &gt;= 0.8.0</p>"},{"location":"CLI/methalign/#refine-alignments","title":"Refine alignments","text":"<ul> <li>Split bam to speed up the refine step <pre><code>cphasing-rs split-bam porec.align.bam -o split_outdir/output.split\ncd split_outdir\n</code></pre></li> </ul> <ul> <li>Refine the alignments by methylation information <pre><code>methalign refine -t 20 contigs.fasta output.methyl.bg output.split_*.bam -o porec.align.refined.paf.gz\n</code></pre></li> </ul> <p>Note</p> <p>This step will output <code>porec.align.refined.paf.gz</code> and <code>porec.align.refined.porec.gz</code></p> <ul> <li>After refine Input <code>porec.align.refined.porec.gz</code> <pre><code>cphasing pipeline -f contigs.fasta -pct porec.align.refined.porec.gz -t 10 -n 8:4 -hcr -p AAGCTT \n</code></pre></li> </ul>"},{"location":"CLI/plot/","title":"Plot","text":""},{"location":"CLI/plot/#examples","title":"Examples","text":""},{"location":"CLI/plot/#plot-chromosome-level-heatmap-from-contig-level-mapping-result","title":"Plot chromosome-level heatmap from contig-level mapping result","text":"<ul> <li>Convert pairs to cool file  </li> </ul> pairs.pqspairs.gz <pre><code>cphasing-rs contigsizes contigs.fa &gt; contigs.contigsizes\ncphasing pairs2cool sample.pairs.pqs contigs.contigsizes sample.10k.cool\n</code></pre> <pre><code>cphasing-rs contigsizes contigs.fa &gt; contigs.contigsizes\ncphasing pairs2cool sample.pairs.gz contigs.contigsizes sample.10k.cool\n</code></pre> <ul> <li>Adjust contig-level matrix to chromosome-level by agp file<pre><code>cphasing plot -a groups.agp -m sample.10k.cool -o groups.500k.wg.png   \n</code></pre> </li> </ul> <p>Note</p> <p>This function will generate two intermedia <code>sample.10000.chrom.cool</code> and <code>sample.500k.chrom.cool</code>.</p> <p> groups.500k.wg.png </p>"},{"location":"CLI/plot/#directly-plot-heatmap-from-cool-file","title":"Directly plot heatmap from <code>.cool</code> file","text":"<pre><code>cphasing plot -m sample.100k.chrom.cool -o groups.100k.wg.png \n</code></pre> <p>Note</p> <p><code>--binsize</code> can be specified when you want to plot a larger resolution, e.g., 500k, <code>plot</code> will automatically generate a 1m matrix from the input matrix. Still, the binsize of the output matrix should be in integer multiples than the binsize of the input matrix.</p> <pre><code>cphasing plot -m sample.100k.chrom.cool -o groups.500k.wg.png -bs 500k\n</code></pre> <p> groups.100k.wg.png groups.500k.wg.png <p></p>"},{"location":"CLI/plot/#gallery-of-different-parameters","title":"Gallery of different parameters","text":""},{"location":"CLI/plot/#add-line-to-highlight-the-haplotype-border","title":"Add line to highlight the haplotype border","text":"<p><pre><code>cphasing plot chrom.500k.cool -o chrom.500k.png --whitered --add-hap-border\n</code></pre> </p>"},{"location":"CLI/plot/#plot-specified-chromosome","title":"Plot specified chromosome","text":""},{"location":"CLI/plot/#plot-all-chromosome-split-in-one-picture","title":"Plot all chromosome split in one picture","text":""},{"location":"CLI/plot/#parameters-of-plot","title":"Parameters of plot","text":"cphasing plot -h<pre><code> Usage: cphasing plot [OPTIONS]                                             \n\n Adjust or Plot the contacts matrix after assembling.                       \n\n \u258c Usage:                                                                   \n \u258c  \u2022 adjust the matrix by agp and plot a heatmap                           \n\n\n  cphasing plot -a groups.agp -m sample.10000.cool -o groups.500k.wg.png    \n\n\n \u258c  \u2022 adjust the matrix by agp and plot a 100k resolution heatmap           \n\n\n  cphasing plot -a groups.agp \\                                             \n      -m sample.10000.cool \\                                                \n      -o groups.100k.wg.png \\                                               \n      -bs 100k                                                              \n\n\n \u258c  \u2022 only plot a heatmap                                                   \n\n\n  cphasing plot -m sample.100k.cool -o sample.100k.png                      \n\n\n \u258c  \u2022 Plot some chromosomes                                                 \n\n\n  cphasing plot -m sample.100k.cool -c Chr01,Chr02 -o Chr01_Chr02.100k.png  \n\n\n\u256d\u2500 Options of Matrix Operation \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 *  --matrix        -m   Contacts matrix stored by Cool format.           \u2502\n\u2502                         (COOL)                                           \u2502\n\u2502                         [required]                                       \u2502\n\u2502    --binsize       -bs  Bin size of the heatmap you want to plot.        \u2502\n\u2502                         Enabled suffix with k or m. [defalt: input       \u2502\n\u2502                         matrix binsize]                                  \u2502\n\u2502                         (STR)                                            \u2502\n\u2502    --only-coarsen       Only coarsen the input matrix, do not need plot  \u2502\n\u2502                         the heatmap.                                     \u2502\n\u2502    --balance            balance the matrix.                              \u2502\n\u2502    --balanced           Plot balanced values, which need cool have       \u2502\n\u2502                         weights columns in bins.                         \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n\u256d\u2500 Options of AGP Adjustment \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 --agp          -a  (AGP)                                                 \u2502\n\u2502 --only-adjust      Only adjust the matrix by agp, do not need plot the   \u2502\n\u2502                    heatmap.                                              \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n\u256d\u2500 Options of Heatmap \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 --chromosomes                   -c         Chromosomes and order in      \u2502\n\u2502                                            which the chromosomes should  \u2502\n\u2502                                            be plotted. Comma seperated.  \u2502\n\u2502                                            or a one column file          \u2502\n\u2502                                            (TEXT)                        \u2502\n\u2502 --regex                         -r         Regular expression of         \u2502\n\u2502                                            chromosomes, only used for    \u2502\n\u2502                                            --chromosomes, e.g. Chr01g.*  \u2502\n\u2502 --disable-natural-sort          -dns       Disable natural sort of       \u2502\n\u2502                                            chromosomes, only used for    \u2502\n\u2502                                            --chromosomes or --only-chr   \u2502\n\u2502 --per-chromosomes,--per-chrom\u2026  -pc        Instead of plotting the whole \u2502\n\u2502                                            matrix, each chromosome is    \u2502\n\u2502                                            plotted next to the other.    \u2502\n\u2502 --only-chr                      -oc        Only plot the chromosomes     \u2502\n\u2502                                            that ignore unanchored        \u2502\n\u2502                                            contigs. When --chromosomes   \u2502\n\u2502                                            specifed, this parameter will \u2502\n\u2502                                            be ignored. The default use   \u2502\n\u2502                                            prefix of Chr to find the     \u2502\n\u2502                                            chromosomes. --chr-prefix can \u2502\n\u2502                                            be used to change this.       \u2502\n\u2502 --chr-prefix                    -cp        Prefix of the chromosomes,    \u2502\n\u2502                                            only used for --only-chr      \u2502\n\u2502                                            (STR)                         \u2502\n\u2502                                            [default: Chr]                \u2502\n\u2502 --chrom-per-row                 -cpr       Number of chromosome plot in  \u2502\n\u2502                                            each row                      \u2502\n\u2502                                            (INTEGER)                     \u2502\n\u2502                                            [default: 4]                  \u2502\n\u2502 --vmin                          -vmin      (FLOAT)                       \u2502\n\u2502 --vmax                          -vmax      (FLOAT)                       \u2502\n\u2502 --scale                         -s         Method of contact             \u2502\n\u2502                                            normalization                 \u2502\n\u2502                                            (STR)                         \u2502\n\u2502                                            [default: log1p]              \u2502\n\u2502 --triangle                                 Plot the heatmap in triangle  \u2502\n\u2502 --fontsize                                 Fontsize of the ticks,        \u2502\n\u2502                                            default is auto               \u2502\n\u2502                                            (INT)                         \u2502\n\u2502 --dpi                           -dpi       Resolution for the image.     \u2502\n\u2502                                            (INTEGER)                     \u2502\n\u2502                                            [default: 600]                \u2502\n\u2502 --cmap,--colormap               -cmap,-cm  Colormap of heatmap.          \u2502\n\u2502                                            Available values can be seen  \u2502\n\u2502                                            :                             \u2502\n\u2502                                            https://pratiman-91.github.i\u2026 \u2502\n\u2502                                            and                           \u2502\n\u2502                                            http://matplotlib.org/exampl\u2026 \u2502\n\u2502                                            and whitered .                \u2502\n\u2502                                            (TEXT)                        \u2502\n\u2502                                            [default: redp1_r]            \u2502\n\u2502 --whitered                      -wr        Preset of --scale none        \u2502\n\u2502                                            --colormap whitered           \u2502\n\u2502 --no-lines                      -nl        Don't add dash line in        \u2502\n\u2502                                            chromosome boundaries.        \u2502\n\u2502 --no-ticks                      -nt        Don't add ticks both in x     \u2502\n\u2502                                            axis and y axis.              \u2502\n\u2502 --rotate-xticks                 -rx        Rotate the x ticks            \u2502\n\u2502                                            [default: True]               \u2502\n\u2502 --rotate-yticks                 -ry        Rotate the x ticks            \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n\u256d\u2500 Global Options \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 --output   -o        Output path of file.                                \u2502\n\u2502                      (TEXT)                                              \u2502\n\u2502                      [default: plot.heatmap.png]                         \u2502\n\u2502 --threads  -t        Number of threads. Used in matrix balance.          \u2502\n\u2502                      (INT)                                               \u2502\n\u2502                      [default: 8]                                        \u2502\n\u2502 --help     -help,-h  Show this message and exit.                         \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n</code></pre>"},{"location":"CLI/rename/","title":"Rename","text":"<p>Rename and reorient the chromosome, according to a monoploid or closely relative species's genome.</p>"},{"location":"CLI/rename/#rename-phased-assembly-from-phasing-mode","title":"Rename phased assembly from <code>phasing</code> mode","text":"<p>The <code>phasing</code> mode of <code>C-Phasing</code> has been clustering the chromsomes into the same homologous and oriented them to parallel. <pre><code>cphasing rename -r mono.fa -f draft.asm.fasta -a groups.agp -t 20 \n</code></pre> </p>"},{"location":"CLI/rename/#rename-all-of-the-chromosomes","title":"Rename all of the chromosomes","text":"<p>Rename assembly from <code>basal</code> or <code>basal_withprune</code> mode, with the <code>--unphased</code> parameter. <pre><code>cphasing rename -r mono.fa -f draft.asm.fasta -a groups.agp -t 20 --unphased \n</code></pre></p> <p></p>"},{"location":"CLI/rename/#use-the-uppercase-letter-as-the-suffix-of-the-chromosome-name","title":"Use the uppercase letter as the suffix of the chromosome name","text":"<p><code>Chr01A Chr01B Chr01C ...</code> <pre><code>cphasing rename -r mono.fa -f draft.asm.fasta -a groups.agp -t 20 -s upperletter\n</code></pre></p> <p></p>"},{"location":"CLI/rename/#parameters","title":"Parameters","text":"<pre><code> Usage: cphasing rename [OPTIONS]                                                                      \n\n Rename and orientation the groups according to a refernce.                                            \n To speed up this function, we only align the first haplotype to reference, because the orientation    \n among different haplotypes has been paralleled in scaffolding. If you want to orient all of the       \n haplotypes you can specify the --unphased parameters.                                                 \n\n\u256d\u2500 Options \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 *  --ref           -r         Genome of monoploid or closely related species.                       \u2502\n\u2502                               (REFERENCE FASTA)                                                     \u2502\n\u2502                               [required]                                                            \u2502\n\u2502 *  --fasta         -f         Path to draft assembly                                                \u2502\n\u2502                               (DRAFT FASTA)                                                         \u2502\n\u2502                               [required]                                                            \u2502\n\u2502 *  --agp           -a         agp file.                                                             \u2502\n\u2502                               (AGP)                                                                 \u2502\n\u2502                               [required]                                                            \u2502\n\u2502    --unphased      -unphased  Haplotypes are not parallel aligned. Rename all of the chromosomes.   \u2502\n\u2502    --suffix-style  -s         The suffix style of renamed chromosome among different haplotypes.    \u2502\n\u2502                               \u2003 number: g1, g2, g3, ... (default)                                   \u2502\n\u2502                               \u2003 upperletter: A, B, C, ...                                           \u2502\n\u2502                               \u2003 lowerletter: a, b, c, ...                                           \u2502\n\u2502                               (STR)                                                                 \u2502\n\u2502                               [default: number]                                                     \u2502\n\u2502    --output        -o         Output path of renamed agp file                                       \u2502\n\u2502                               (OUTPUT_AGP)                                                          \u2502\n\u2502    --threads       -t         Number of threads.                                                    \u2502\n\u2502                               (INT)                                                                 \u2502\n\u2502                               [default: 8]                                                          \u2502\n\u2502    --help          -h,-help   Show this message and exit.                                           \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n</code></pre>"},{"location":"tutorials/hic/hic_decaploid/","title":"Assemble autodecaploid by Hi-C","text":"<p>Autodecaploid (2n=8x=80)</p> <pre><code>cphasing pipeline -f decaploid_hifi.bp.p_utg.fasta -hic1 hic_R1.fastq.gz -hic2 hic_R2.fastq.gz -t 40 -n 8:10 -hcr -p AAGCTT \n</code></pre>"},{"location":"tutorials/hic/hic_monoploid/","title":"Assemble a monoploid of diploid","text":"<p>Diploid (2n=2x=24)</p> <pre><code>cphasing pipeline -f monoploid_ctg.fasta -hic1 hic_R1.fastq.gz -hic2 hic_R2.fastq.gz -t 40 -n 12\n</code></pre>"},{"location":"tutorials/hic/hic_sugarcane/","title":"Assemble hybrid sugarcane by Hi-C","text":"<p>Aneuploidy (2n=114), estimate genome size ~ 10 Gb </p>"},{"location":"tutorials/hic/hic_sugarcane/#hi-c-data-processing","title":"Hi-C data processing","text":"<p>Due to the huge porec data, we mapped each cell to fasta by submitting this command to cluster, respectively. And merged them into one file by <code>cphasing pairs-merge</code>.</p> <p>Note</p> <p>Please submit one first; wait until the index is successfully created and the remaining jobs are enabled to submit to the cluster.</p> <pre><code>cphasing hic mapper -f sh_hifi.bp.p_utg.fasta -hic1 hic-1_R1.fastq.gz -hic2 hic-1_R2.fastq.gz -t 40 -k 27 -w 14 \n</code></pre> <pre><code>cphasing hic mapper -f sh_hifi.bp.p_utg.fasta -hic1 hic-2_R1.fastq.gz -hic2 hic-2_R2.fastq.gz -t 40 -k 27 -w 14 \ncphasing hic mapper -f sh_hifi.bp.p_utg.fasta -hic1 hic-3_R1.fastq.gz -hic2 hic-3_R2.fastq.gz -t 40 -k 27 -w 14 \ncphasing hic mapper -f sh_hifi.bp.p_utg.fasta -hic1 hic-4_R1.fastq.gz -hic2 hic-4_R2.fastq.gz -t 40 -k 27 -w 14 \n</code></pre> <pre><code>cphasing pairs-merge hic-*.pairs.pqs -o hic.merge.pairs.pqs \n</code></pre>"},{"location":"tutorials/hic/hic_sugarcane/#assembling-by-cphasing-pipeline","title":"Assembling by <code>cphasing pipeline</code>","text":"<p>Modern hybrid sugarcane is an aneuploid, which contains an unequal number of chromosomes in each homologous group, so we set <code>-n 0:0</code> to automatically output cluster numbers. <pre><code>cphasing pipeline -f sh_hifi.bp.p_utg.fasta -pct hic.mrege.pairs.pqs -t 40 -n 0:0 -hcr -p AAGCTT \n</code></pre></p>"},{"location":"tutorials/hic/hic_tetraploid/","title":"Assemble tetraploid by Hi-C","text":""},{"location":"tutorials/porec/porec_decaploid/","title":"Assemble autodecaploid by Pore-C","text":"<p>Autodecaploid (2n=8x=80)</p> <pre><code>cphasing pipeline -f decaploid_hifi.bp.p_utg.fasta -pcd porec.fastq.gz -t 40 -n 8:10 -hcr -p AAGCTT \n</code></pre>"},{"location":"tutorials/porec/porec_monoploid/","title":"Assemble a monoploid of diploid","text":"<p>Diploid (2n=2x=24)</p> <pre><code>cphasing pipeline -f monoploid_ctg.fasta -pcd porec.fastq.gz -t 40 -n 12\n</code></pre>"},{"location":"tutorials/porec/porec_sugarcane/","title":"Assemble hybrid sugarcane by Pore-C","text":"<p>Aneuploidy (2n=114), estimate genome size ~ 10 Gb </p>"},{"location":"tutorials/porec/porec_sugarcane/#pore-c-data-processing","title":"Pore-C data processing","text":"<p>Due to the huge porec data, we mapped each cell to fasta by submitting this command to cluster, respectively. And merged them into one file by <code>cphasing porec-merge</code> <pre><code>cphasing mapper sh_hifi.bp.p_utg.fasta porec-1.fastq.gz -t 40 \ncphasing mapper sh_hifi.bp.p_utg.fasta porec-2.fastq.gz -t 40 \ncphasing mapper sh_hifi.bp.p_utg.fasta porec-3.fastq.gz -t 40 \ncphasing mapper sh_hifi.bp.p_utg.fasta porec-4.fastq.gz -t 40 \ncphasing mapper sh_hifi.bp.p_utg.fasta porec-5.fastq.gz -t 40 \n</code></pre></p> <pre><code>cphasing porec-merge porec-*.porec.gz -o porec.merge.porec.gz \n</code></pre>"},{"location":"tutorials/porec/porec_sugarcane/#assembling-by-cphasing-pipeline","title":"Assembling by <code>cphasing pipeline</code>","text":"<p>Modern hybrid sugarcane is an aneuploid, which contains an unequal number of chromosomes in each homologous group, so we set <code>-n 0:0</code> to automatically output cluster numbers. <pre><code>cphasing pipeline -f sh_hifi.bp.p_utg.fasta -pct porec.mrege.porec.gz -t 40 -n 0:0 -hcr -p AAGCTT \n</code></pre></p>"},{"location":"tutorials/porec/porec_tetraploid/","title":"Assemble tetraploid by Pore-C","text":""},{"location":"zh/","title":"\u5b89\u88c5","text":"C-Phasing <p> Phasing and scaffolding polyploid genomes based on Pore-C, HiFi-C, Ultra-long, or Hi-C data</p> <p>.</p>"},{"location":"zh/#_1","title":"\u4ecb\u7ecd","text":"<p>\u4f7f\u7528Hi-C\u6570\u636e\u5b9e\u73b0\u591a\u500d\u4f53\u57fa\u56e0\u7ec4\u5206\u578b\u6302\u8f7d\uff0c\u5b58\u5728\u4e3b\u8981\u95ee\u9898\u4e4b\u4e00\u662f\u5927\u91cf\u4e0d\u660e\u786e\u7684\u77ed\u8bfb\u957f\u6bd4\u5bf9\uff0c\u8fd9\u5bb9\u6613\u5bfc\u81f4\u9ad8\u6c34\u5e73\u7684\u4ea4\u6362\u6216\u5d4c\u5408\u7ec4\u88c5\u9519\u8bef\u3002\u73b0\u5728\uff0c\u57fa\u4e8e\u957f\u8bfb\u957f\u7684\u67d3\u8272\u4f53\u6784\u8c61\u6355\u83b7\u6280\u672f\uff0c\u5982Pore-C\u3001HiFi-C\uff0c\u4e3a\u514b\u670d\u8fd9\u4e00\u95ee\u9898\u63d0\u4f9b\u4e86\u6709\u6548\u9014\u5f84\u3002\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u5f00\u53d1\u4e86\u4e00\u4e2a\u65b0\u7684\u6d41\u7a0b\uff0c\u5373\u201cC-Phasing\u201d\uff0c\u5b83\u662f\u4e13\u95e8\u4e3a\u591a\u500d\u4f53\u5206\u578b\u7ec4\u88c5\u91cf\u8eab\u5b9a\u5236\u7684\uff0c\u65e8\u5728\u5145\u5206\u5229\u7528Pore-C\u6216HiFi-C\u6570\u636e\u7684\u4f18\u52bf\u3002\u6b64\u5916\uff0c\u5b83\u4e5f\u53ef\u7528\u4e8eHi-C\u6570\u636e\u548c\u4e8c\u500d\u4f53\u57fa\u56e0\u7ec4\u7ec4\u88c5\u3002</p> <p><code>C-Phasing</code>\u7684\u4f18\u52bf:      - \u5feb\u901f.      - \u66f4\u9ad8\u7684\u6302\u8f7d\u7387.     - \u66f4\u9ad8\u7684\u5206\u578b\u7ec4\u88c5\u8d28\u91cf.</p>"},{"location":"zh/#_2","title":"\u5b89\u88c5","text":"recommendedcondacustom <p>\u4eceGitHub\u5b98\u7f51\u4e0b\u8f7d<code>C-Phasing</code>\u8f6f\u4ef6\uff0c\u5e76\u52a0\u8f7d<code>activate_cphasing</code>\u6fc0\u6d3b\u73af\u5883\u3002 <pre><code>git clone https://github.com/wangyibin/CPhasing.git\n\nsource ./CPhasing/bin/activate_cphasing\n</code></pre></p> <p>Note</p> <p>\u7b2c\u4e00\u6b21\u914d\u7f6e\u9700\u8981\u5728\u6709\u7f51\u7edc\u7684\u60c5\u51b5\u4e0b\u8fd0\u884c<code>./CPhasing/bin/activate_cphasing</code>.</p> <p>Note</p> <p>\u5982\u679c\u4f60\u7684\u670d\u52a1\u5668\u4e0d\u80fd\u8bbf\u95eeanaconda\u7684\u4ed3\u5e93\uff0c\u53ef\u4ee5\u914d\u7f6e\u955c\u50cf\u6e90\uff0c\u5982\u914d\u7f6e\u6d59\u6c5f\u5927\u5b66\u7684\u955c\u50cf\u6e90\uff1a 1. \u6253\u5f00\u914d\u7f6e\u6587\u4ef6 <pre><code>~/.pixi/bin/pixi config edit\n</code></pre> 2. \u5199\u5165\u4ee5\u4e0b\u5185\u5bb9 <pre><code>[mirrors]\n\"https://conda.anaconda.org/conda-forge\" = [\n    \"https://mirrors.zju.edu.cn/anaconda/cloud/conda-forge\"\n]\n\n\"https://conda.anaconda.org/bioconda\" = [\n    \"https://mirrors.zju.edu.cn/anaconda/cloud/bioconda\"\n]\n</code></pre> 3. Ctrl+X+Y : \u6309<code>ctrl + X</code>\uff0c\u7136\u540e\u518d\u6309<code>Y</code>, \u4fdd\u5b58\u9000\u51fa</p> <p>\u4eceGitHub\u5b98\u7f51\u4e0b\u8f7d<code>C-Phasing</code>\u8f6f\u4ef6\uff0c\u4f7f\u7528anaconda\u6216\u8005miniconda\u914d\u7f6e\u73af\u5883\u548c\u6fc0\u6d3b\u73af\u5883\u3002 <pre><code>git clone https://github.com/wangyibin/CPhasing.git\n\ncd CPhasing\nconda env create -f environment.yml\nconda activate cphasing\n</code></pre> \u63a5\u7740\u914d\u7f6e\u4ee5\u4e0b\u547d\u4ee4\u9053\u73af\u5883\u53d8\u91cf <code>.bash_profile</code>\u6216\u8005<code>.bashrc</code> ~/.bash_profile<pre><code>export PATH=/path/to/CPhasing/bin:$PATH\nexport PYTHONPATH=/path/to/CPhasing:$PYTHONPATH\n</code></pre></p> <p>Note</p> <p>\u5728\u6bd4\u5bf9Hi-C\u6570\u636e\u7684\u65f6\u5019\uff0c\u6709\u7528\u6237\u9047\u5230\u627e\u4e0d\u5230<code>GLIBCXX_3.4.29</code>\u7684\u62a5\u9519\uff0c\u8fd9\u79cd\u60c5\u51b5\u53ef\u4ee5\u5728\u8fd0\u884c<code>cphasing</code>\u547d\u4ee4\u524d\uff0c\u914d\u7f6e\u4ee5\u4e0b\u547d\u4ee4\uff1a run.sh<pre><code>export LD_LIBRARY_PATH=/path/to/anaconda3/envs/cphasing/lib:$LD_LIBRARY_PATH\n</code></pre></p> <ul> <li>\u57fa\u672c\u7528\u6cd5 <p>\u4f7f\u7528 <code>pipeline</code>\u547d\u4ee4\u5f00\u59cb\u8fd0\u884c<code>cphasing</code>.  </p> <p>\u57fa\u672c\u7528\u6cd5</p> </li> </ul> <ul> <li>\u6559\u7a0b <p>\u4e00\u4e9b\u6848\u4f8b\u6559\u4f60\u5982\u4f55\u8fd0\u884c <code>cphasing</code>. Tutorials</p> </li> </ul>"},{"location":"zh/#githubcphasing-pip","title":"\u4eceGitHub\u4e0b\u8f7d<code>CPhasing</code>, \u7136\u540e\u4f7f\u7528<code>pip</code>\u5b89\u88c5\u3002","text":"<p><pre><code>## Download C-Phasing and install python dependencies\ngit clone https://github.com/wangyibin/CPhasing.git\ncd CPhasing\npip install .\n</code></pre> \u63a5\u7740\u914d\u7f6e\u4ee5\u4e0b\u547d\u4ee4\u9053\u73af\u5883\u53d8\u91cf <code>~/.bash_profile</code> \u6216\u8005<code>~/.bashrc</code> ~/.bash_profile<pre><code>export PATH=/path/to/CPhasing/bin:$PATH\n</code></pre></p>"},{"location":"zh/#_3","title":"\u7b2c\u4e09\u65b9\u4f9d\u8d56\u5305","text":"<ol> <li>\u6838\u5fc3\u529f\u80fd\u4f9d\u8d56\uff1a     - bedtools     - seqkit     - pigz </li> <li>Pore-C\u6d41\u7a0b\u4f9d\u8d56\uff1a      - minimap2(&gt;= v2.24)  </li> </ol>"},{"location":"zh/basic_usage/","title":"\u6d41\u7a0b\u5316\u7684\u547d\u4ee4","text":""},{"location":"zh/basic_usage/#pipeline","title":"pipeline\u547d\u4ee4","text":"<p>\u4ee5\u4e0b\u6848\u4f8b\u4e2d\u7684\u53c2\u6570<code>-n 8:4</code>\u8868\u793a\u7ec4\u88c5\u4e00\u4e2a\u67d3\u8272\u4f53\u57fa\u6570\u4e3a8\u7684\u56db\u500d\u4f53\uff084\uff09\uff0c\u6307\u5b9a\u7a0b\u5e8f\u7b2c\u4e00\u6b21\u5206\u7ec4\u8f93\u51fa8\u7ec4\uff0c\u7b2c\u4e8c\u6b21\u518d\u6bcf\u4e00\u7ec4\u91cc\u9762\u8f93\u51fa4\u7ec4\uff0c\u6700\u7ec8\u8f93\u51fa32\u6761\u67d3\u8272\u4f53\u3002\u6211\u4eec\u4e5f\u652f\u6301\u81ea\u52a8\u5206\u7ec4\uff0c\u53ea\u9700\u8bbe\u7f6e<code>-n 0:0</code>, \u8fd9\u8868\u793a\u4e24\u8f6e\u81ea\u52a8\u5206\u7ec4\u3002\u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u7b2c\u4e00\u5206\u62108\u7ec4\u7b2c\u4e8c\u6b21\u81ea\u52a8\u5206\u7ec4\uff08<code>-n 8:0</code>\uff09\u6216\u8005\u7b2c\u4e00\u6b21\u81ea\u52a8\u5206\u7ec4\u7b2c\u4e8c\u6b21\u52064\u7ec4\uff08<code>-n 0:8</code>)</p> <p>Note</p> <p>CPhasing\u4e5f\u652f\u6301\u5355\u5957\u57fa\u56e0\u7ec4\u7684\u6302\u8f7d\uff0c\u53ea\u9700\u8bbe\u7f6e\u4e00\u4e2a\u5206\u7ec4\u6570\uff0c\u4f8b\u5982<code>-n 8</code>\uff0c\u67d3\u8272\u4f53\u6570\u4e3a8\uff0c\u671f\u671b\u7a0b\u5e8f\u5c06contig\u5206\u62108\u6761\u67d3\u8272\u4f53\u3002<code>pipeline</code>\u4f1a\u81ea\u52a8\u8df3\u8fc7<code>1.allele</code>\u8fd9\u6b65\uff0c\u5e76\u4e14\u53ea\u6267\u884c\u4e00\u6b21contig\u5206\u7ec4.</p> <p>Note</p> <p>\u5982\u679c\u7528\u6237\u8f93\u5165\u7684\u57fa\u56e0\u7ec4\u4e3a\u5f02\u6e90\u591a\u500d\u4f53\uff0c\u4e9a\u57fa\u56e0\u7ec4\u7684\u76f8\u4f3c\u6027\u8f83\u4f4e\uff0c\u53ef\u80fd\u65e0\u6cd5\u5b9e\u73b0\u7406\u60f3\u7684\u7b2c\u4e00\u6b21\u5206\u7ec4\uff0c\u7528\u6237\u5e94\u8be5\u8bbe\u7f6e\u4e0d\u540c\u7684<code>-n</code>\u53c2\u6570\uff0c\u4f8b\u5982\u5f02\u6e90\u56db\u500d\u4f53(2n=4x=32)\uff0c\u7ec4\u88c5\u4e24\u5957\u4e9a\u57fa\u56e0\u7ec4\u7684\u8bdd\uff0c\u5e94\u8be5\u628a\u5b83\u5f53\u6210\u65e0\u9700\u5206\u578b\u7684\u4e8c\u500d\u4f53\u7ec4\u88c5\uff0c\u8bbe\u7f6e<code>-n 16</code>, \u9700\u8981\u5bf9\u4e24\u5957\u4e9a\u57fa\u56e0\u7ec4\u5206\u522b\u5206\u578b\u7684\u8bdd\u53ef\u4ee5\u8bbe\u7f6e<code>-n 16:2</code>\u3002 \u5982\u679c\u4e3a\u5f02\u6e90\u516d\u500d\u4f53(AAABBB, 2n=6x=48), \u53ef\u4ee5\u8bbe\u7f6e<code>-n 16:3</code>\uff0c\u800c\u5f02\u6e90\u7559\u500d\u4f53\uff08AABBCC\uff0c2n=6x=48\uff09\uff0c\u5219\u8bbe\u7f6e<code>-n 24:2</code>\u3002</p> <p>Tip</p> <p>\u5982\u679c\u662fhifiasm\u7ec4\u88c5\u7684contig\uff0c\u7ec4\u88c5\u5206\u578b\u7684\u57fa\u56e0\u7ec4\u9009\u62e9\u8f93\u5165<code>p_utg.fasta</code>, \u6216\u8005\u7528\u6237\u53ef\u4ee5\u5c1d\u8bd5\u5408\u5e76hifiasm (hic)\u8f93\u51fa\u7684\u591a\u4e2ahap*.p_utg.fasta\u3002</p>"},{"location":"zh/basic_usage/#pore-c-reads","title":"\u8f93\u5165 Pore-C \u6d4b\u5e8freads:","text":"<pre><code>cphasing pipeline -f draft.asm.fasta -pcd sample.fastq.gz -t 10 -n 8:4\n</code></pre>"},{"location":"zh/basic_usage/#pore-c-data","title":"\u8f93\u5165\u591a\u7ec4 Pore-C data:","text":"<p>\u6bcf\u4e2a\u6570\u636e\u6307\u5b9a\u4e00\u6b21<code>-pcd</code>\u53c2\u6570 <pre><code>cphasing pipeline -f draft.asm.fasta -pcd sample1.fastq.gz -pcd sample2.fastq.gz -t 10 -n 8:4\n</code></pre></p> <p>Note</p> <p>\u5982\u679c\u4f60\u5e0c\u671b\uff0c\u5c06\u4e0d\u540ccell\u7684\u6570\u636e\u5206\u522b\u6295\u9012\u5230\u4e0d\u540c\u7684\u8282\u70b9\u4e0a\u8dd1\uff0c\u53ef\u4ee5\u4f7f\u7528<code>cphasing mapper</code>\u53c2\u6570\uff0c\u5e76\u6700\u540e\u4f7f\u7528<code>cphasing-rs porec-merge</code>\u5c06\u8f93\u51fa\u7684<code>porec.gz</code> \u6587\u4ef6\u5408\u5e76\u4e3a\u4e00\u4e2a<code>.merge.porec.gz</code>, \u7136\u540e\u518d\u901a\u8fc7<code>-pct</code>\u53c2\u6570\u8f93\u5165\u3002\u8be6\u7ec6\u6587\u6863Mapper</p>"},{"location":"zh/basic_usage/#pore-c-table-porecgz","title":"\u8f93\u5165 Pore-C table (<code>.porec.gz</code>):","text":"<p>\u8fd9\u79cd\u6587\u4ef6\u662f\u7531<code>cphasing mapper</code>\u4ea7\u751f\u7684. <pre><code>cphasing pipeline -f draft.asm.fasta -pct sample.porec.gz -t 10 -n 8:4\n</code></pre></p>"},{"location":"zh/basic_usage/#hifi-c","title":"\u8f93\u5165HiFi-C\u6570\u636e","text":"<p>\u4ec5\u9700\u6bd4\u5bf9\u7684\u65f6\u5019\u66f4\u6539\u4e3a<code>pipeline</code>\u6216\u8005<code>mapper</code>\u7684<code>--mm2-params \"-x map-hifi\"</code>\u53c2\u6570. \u5269\u4e0b\u6b65\u9aa4\u548c\u751f\u6210\u7684\u6587\u4ef6\u90fd\u4e0ePore-C\u6570\u636e\u4e00\u81f4\u3002 <pre><code>cphasing pipeline -f draft.asm.fasta -pcd hific.fastq.gz --mm2-params \"-x map-hifi\" -t 10 -n 8:4\n</code></pre></p> <p>Note</p> <p>HiFi-C\u7684\u6bd4\u5bf9\u7ed3\u679c\u4ee5<code>.porec.gz</code>\u7ed3\u5c3e\uff0c\u5904\u7406\u65b9\u5f0f\u4e0ePore-C\u4e00\u81f4\uff0c\u5747\u53ef\u7528<code>porec-merge</code>\u3001<code>porec-intersect</code>\u7b49\u547d\u4ee4\u5904\u7406\u3002</p>"},{"location":"zh/basic_usage/#hi-c-data","title":"\u8f93\u5165Hi-C data\u6570\u636e","text":"<pre><code>cphasing pipeline -f draft.asm.fasta -hic1 Lib_R1.fastq.gz -hic2 Lib_R2.fastq.gz -t 10 -n 8:4\n</code></pre> <p>Note</p> <ul> <li>1 | <code>cphasing pipeline</code> \u4e0d\u652f\u6301\u8f93\u5165\u591a\u7ec4Hi-C\u6570\u636e\uff0c\u4f46\u662f\u7528\u6237\u53ef\u4ee5\u81ea\u884c\u4f7f\u7528<code>cphasing hic mapper</code> \u8fdb\u884c\u6bd4\u5bf9\uff0c\u7136\u540e\u518d\u4f7f\u7528<code>cphasing-rs pairs-merge</code> \u5408\u5e76\u6240\u6709\u7684<code>.pairs.gz</code>\u6587\u4ef6, \u7136\u540e\u901a\u8fc7 <code>-prs</code> \u53c2\u6570\u8f93\u5165.  </li> <li>2 | \u5982\u679c\u57fa\u56e0\u7ec4\u7684\u5927\u5c0f\u5927\u4e8e8Gb\uff0c\u9700\u8981\u63d0\u9ad8\u6bd4\u5bf9\u7684<code>k</code> \u548c<code>w</code>\u7684\u5927\u5c0f\uff0c\u907f\u514d<code>chromap</code>\u62a5\u9519\uff0c\u4f8b\u5982 <code>-hic-mapper-k 27 -hic-mapper-w 14</code>.</li> </ul>"},{"location":"zh/basic_usage/#4dn-pairs-pairsgz-or-pairspqs","title":"\u8f93\u51654DN pairs (<code>.pairs.gz</code> or <code>.pairs.pqs</code>)\u6587\u4ef6","text":"<code>pairs.pqs</code><code>pairs.gz</code> <pre><code>cphasing pipeline -f draft.asm.fasta -prs sample.pairs.pqs -t 10 -n 8:4\n</code></pre> <pre><code>cphasing pipeline -f draft.asm.fasta -prs sample.pairs.gz -t 10 -n 8:4\n</code></pre>"},{"location":"zh/basic_usage/#_2","title":"\u8df3\u8fc7\u4e00\u4e9b\u6b65\u9aa4","text":"<pre><code>## skip steps 1.alleles and 2.prepare steps \ncphasing pipeline -f draft.asm.fasta -pct sample.porec.gz -t 10 -ss 1,2\n</code></pre>"},{"location":"zh/basic_usage/#_3","title":"\u53ea\u8dd1\u67d0\u4e00\u6b65","text":"<pre><code>## run 3.hyperpartition \ncphasing pipeline -f draft.asm.fasta -pct sample.porec.gz -t 10 -s 3\n</code></pre> <p>Tips</p> <p><code>-s 3,4</code> to run step 3 and 4.</p>"},{"location":"zh/basic_usage/#_4","title":"\u63d0\u5347\u7ec4\u88c5\u8d28\u91cf","text":"<p>\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\uff0c\u8bbe\u7f6e<code>-hcr</code>\u53c2\u6570\u4f1a\u4f7f\u5f97\u7ec4\u88c5\u8d28\u91cf\u66f4\u9ad8\uff0c\u867d\u7136\u8fd9\u4f1a\u8ba9\u8fd0\u884c\u901f\u5ea6\u53d8\u6162\uff0c\u4f46\u662f\u8be5\u53c2\u6570\u7684\u8bbe\u7f6e\u53ef\u4ee5\u6709\u6548\u53bb\u9664\u4e00\u4e9b\u5728\u5168\u57fa\u56e0\u7ec4\u9891\u7e41\u4e92\u4f5c\u7684\u533a\u57df\u5bf9\u5206\u578b\u7684\u5f71\u54cd\u3002\u540c\u65f6\u7531\u4e8e\u9176\u5207\u4f4d\u70b9\u5206\u5e03\u7684\u504f\u597d\u6027\uff0c\u5efa\u8bae\u6307\u5b9a<code>-p AAGCTT</code> \u8fdb\u884c\u6807\u51c6\u5316\u3002 <pre><code>cphasing pipeline -f draft.asm.fasta -pct sample.porec.gz -t 10 -hcr -p AAGCTT \n</code></pre></p>"},{"location":"zh/basic_usage/#juicebox","title":"\u901a\u8fc7Juicebox \u4eba\u5de5\u8c03\u6574\u57fa\u56e0\u7ec4\u7ec4\u88c5","text":"<ul> <li>\u9996\u5148\u9700\u8981\u751f\u6210\u4e24\u4e2a\u6587\u4ef6\uff1a<code>.assembly</code> \u548c <code>.hic</code>, \u4ee5\u4e0b\u6b65\u9aa4\u4f9d\u8d56\u4e8e3d-dna \u8f6f\u4ef6\uff0c\u7528\u6237\u9700\u81ea\u884c\u5b89\u88c5\u3002</li> </ul> <pre><code>cphasing pairs2mnd sample.pairs.gz -o sample.mnd.txt\ncphasing utils agp2assembly groups.agp &gt; groups.assembly\nbash ~/software/3d-dna/visualize/run-assembly-visualizer.sh sample.assembly sample.mnd.txt\n</code></pre> <p>Note</p> <p>\u5982\u679ccontig\u8fdb\u884c\u5d4c\u5408\u7ea0\u9519\uff0c\u8bf7\u4f7f\u7528<code>groups.corrected.agp</code>\uff0c\u5e76\u4ece\u539f\u59cb\u7684<code>pairs.gz</code>\u901a\u8fc7<code>cphasing-rs pairs-break</code>  \u751f\u6210\u4e00\u4e2a\u65b0\u7684 <code>corrected.pairs.gz</code>\u3002</p> <ul> <li>\u8c03\u6574\u5b8c\u540e\u751f\u6210agp\u548cfasta\u6587\u4ef6 <pre><code>## convert assembly to agp\ncphasing utils assembly2agp groups.review.assembly -n 8:4 \n## or haploid or a homologous group\ncphasing utils assembly2agp groups.review.assembly -n 8\n## extract contigs from agp \ncphasing agp2fasta groups.review.agp draft.asm.fasta --contigs &gt; contigs.fasta\n## extract chromosome-level fasta from agp\ncphasing agp2fasta groups.review.agp draft.asm.fasta &gt; groups.review.asm.fasta\n</code></pre></li> </ul>"},{"location":"zh/basic_usage/#_5","title":"\u6839\u636e\u53c2\u8003\u57fa\u56e0\u7ec4\u91cd\u65b0\u547d\u540d\u548c\u8c03\u6574\u6574\u6761\u67d3\u8272\u4f53\u7684\u65b9\u5411","text":"<p>\u6211\u4eec\u5185\u7f6e\u4e86<code>cphasing rename</code>\u547d\u4ee4\uff0c\u8be5\u547d\u4ee4\u53ef\u4ee5\u6839\u636e\u4e00\u5957\u5355\u500d\u578b\u6216\u8005\u8fd1\u7f18\u7269\u79cd\u7684\u67d3\u8272\u4f53\u6c34\u5e73\u57fa\u56e0\u7ec4\u53bb\u8c03\u6574\u591a\u500d\u4f53\u5206\u578b\u7ec4\u88c5\u7684\u67d3\u8272\u4f53\u7f16\u53f7\u548c\u6574\u6761\u67d3\u8272\u4f53\u7684\u65b9\u5411\u65b9\u5411\uff0c\u53ef\u4ee5\u67e5\u770b\u8be6\u7ec6\u7684\u6587\u6863Rename <pre><code>cphasing rename -r mono.fasta -f draft.asm.fasta -a groups.review.agp -t 20\n</code></pre></p> <p>Note</p> <p>\u4e3a\u4e86\u51cf\u5c11\u65f6\u95f4\u6d88\u8017\uff0c\u6211\u4eec\u53ea\u5bf9\u6bcf\u5957\u540c\u6e90\u67d3\u8272\u4f53\u7ec4\u5185\u7684\u7b2c\u4e00\u6761\u8fdb\u884c\u6bd4\u5bf9\uff0c\u7136\u540e\u6839\u636e\u6b64\u6bd4\u5bf9\u7ed3\u679c\uff0c\u5bf9\u6574\u4e2a\u540c\u6e90\u7ec4\u8fdb\u884c\u91cd\u547d\u540d\u548c\u8c03\u6574\u65b9\u5411\u3002\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u5728<code>scaffolding</code>\u6b65\u9aa4\u7684\u65f6\u5019\u5df2\u7ecf\u628a\u540c\u6e90\u67d3\u8272\u4f53\u7684\u65b9\u5411\u8c03\u6574\u4e3a\u4e00\u81f4\u4e86\u3002\u5982\u679c\u4f60\u9700\u8981\u5bf9\u6240\u6709\u540c\u6e90\u7ec4\u5185\u7684\u67d3\u8272\u4f53\u8fdb\u884c\u6bd4\u5bf9\uff0c\u53ef\u4ee5\u8bbe\u7f6e<code>--unphased</code>\u53c2\u6570\u5b9e\u73b0\u3002</p>"},{"location":"zh/basic_usage/#_6","title":"\u7ed8\u5236\u70ed\u56fe","text":"<p>\u67e5\u770b\u8be6\u7ec6\u6587\u6863Plot</p>"},{"location":"zh/faq/","title":"\u5e38\u89c1\u95ee\u9898","text":""},{"location":"zh/faq/#_1","title":"\u7b2c\u4e00\u8f6e\u5206\u7ec4\u7684\u7ed3\u679c\u4e0d\u597d:","text":"<p>\u5728\u6211\u4eec\u7684\u4e24\u8f6e\u805a\u7c7b\u7b97\u6cd5\u4e2d\uff0c\u7b2c\u4e00\u8f6e\u805a\u7c7b\u4f9d\u8d56\u4e8e\u540c\u6e90\u67d3\u8272\u4f53\u4e4b\u95f4\u6bd4\u5bf9\u9519\u8bef\uff1b\u5982\u679c\u7528\u6237\u8f93\u5165\u4f4e\u6c34\u5e73Switch error\u7684contigs\u6216\u8f93\u5165\u9ad8\u7cbe\u5ea6\u7684Pore-c\u6570\u636e\uff0ch-trans\u5c06\u4e0d\u8db3\u4ee5\u652f\u6491\u5c06\u6765\u81ea\u540c\u6e90\u67d3\u8272\u4f53\u7684contig\u805a\u5230\u4e00\u8d77\uff0c\u8fd9\u5bb9\u6613\u5bfc\u81f4\u7ed3\u679c\u4e0d\u7406\u60f3\u3002\u7528\u6237\u53ef\u4ee5\u4e3a<code>hyperpartition</code>\u6216<code>pipeline</code>\u8bbe\u7f6e<code>-q1 0</code>\u4ee5\u589e\u52a0h-trans\u9519\u8bef\u7387\u3002\u4f46\u662f\uff0c\u5f53\u60a8\u5728porec.gz\u6216pairs.gz\u4e2d\u8f93\u5165\u5927\u91cf\u7684\u4e92\u4f5c\u6570\u636e\u65f6\uff0c\u6b64\u53c2\u6570\u53ef\u80fd\u4f1a\u5f15\u53d1\u5185\u5b58\u4e0d\u8db3\u7684\u9519\u8bef\u3002 </p>"},{"location":"zh/faq/#_2","title":"\u6302\u8f7d\u4e0a\u7684\u67d3\u8272\u4f53\u603b\u5927\u5c0f\u8fdc\u4f4e\u4e8e\u9884\u4f30\u57fa\u56e0\u7ec4\u5927\u5c0f","text":"<p>\u5982\u679c\u5b58\u5728\u4ee5\u4e0b\u4e24\u79cd\u60c5\u51b5\uff0c\u53ef\u4ee5\u901a\u8fc7\u8c03\u6574 <code>cphasing pipeline</code>\u7684\u6a21\u5f0f\u81f3\u654f\u611f\uff08<code>--preset sensitive</code>\uff09\u6216\u8005\u8d85\u654f\u611f\uff08<code>--preset very-sensitive</code>\uff09 1. \u8f93\u5165\u7684\u6570\u636e\u91cf\u4f4e\u30022. \u8f93\u5165\u7684\u57fa\u56e0\u7ec4\u8f83\u4e3a\u590d\u6742\uff0c\u5b58\u5728\u5927\u91cf\u7684\u7eaf\u5408\u6216\u8005\u8fd1\u4e4e\u7eaf\u5408\u7684\u533a\u57df\u3002 \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4ee5\u4e0a\u4e24\u79cd\u6a21\u5f0f\u4f1a\u8ba9\u90e8\u5206\u8f83\u788e\u7684contig\u805a\u7c7b\u6216\u8005\u6392\u5e8f\u9519\u8bef\u3002\u540c\u65f6\u5982\u679c\u5c5e\u4e8e\u7b2c\u4e8c\u79cd\u60c5\u51b5\uff0c\u5bb9\u6613\u53d1\u751f\u8d2a\u5a6a\u7684\u805a\u7c7b\uff0c\u5373\u4e24\u6761\u9ad8\u5ea6\u540c\u6e90\u7684\u67d3\u8272\u4f53\u7ec4\u88ab\u5206\u5230\u4e00\u7ec4\u91cc\u9762\u3002</p>"},{"location":"zh/faq/#-n","title":"\u5982\u4f55\u5728\u7ec4\u88c5\u975e\u6574\u500d\u4f53\u57fa\u56e0\u7ec4\u65f6\u8bbe\u7f6e<code>-n</code>\u53c2\u6570:","text":"<p>\u975e\u6574\u500d\u4f53\u57fa\u56e0\u7ec4\uff0c\u5982\u73b0\u4ee3\u683d\u57f9\u7684\u7518\u8517\uff0c\u5305\u542b\u6570\u76ee\u4e0d\u76f8\u7b49\u7684\u540c\u6e90\u67d3\u8272\u4f53\u3002\u6211\u4eec\u5efa\u8bae<code>-n</code>\u53c2\u6570\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u96f6\uff08<code>-n 0:0</code>\uff09\uff0c\u8ba9\u7a0b\u5e8f\u81ea\u52a8\u5224\u522b\u5206\u7ec4\u6570\u3002 \u6b64\u5916\uff0c\u6211\u4eec\u4e5f\u5141\u8bb8\u7528\u6237\u8f93\u5165\u4e00\u4e2a\u5305\u542b\u4e24\u5217\u7684\u6587\u4ef6\uff1a\u7b2c\u4e00\u5217\u662f\u7b2c\u4e00\u8f6e\u5206\u533a\u7684\u7d22\u5f15\uff081-base\uff09\uff0c\u7b2c\u4e8c\u5217\u662f\u6bcf\u4e2a\u540c\u6e90\u67d3\u8272\u4f53\u7684\u67d3\u8272\u4f53\u6570\u76ee\u3002\u7136\u540e\u6307\u5b9a<code>- n10:second.number.tsv</code>\u3002\u5728<code>cphasing pipeline</code>\u6216<code>cphasing hyperpartition</code>\u4e2d\u4f7f\u7528\u3002</p> second.number.tsv<pre><code>1    13\n2    12\n3    12\n4    11\n5    10\n6    12\n7    12\n8    10\n9    12\n10    12\n</code></pre>"},{"location":"zh/CLI/collapse/","title":"Collapse","text":"<p>\u584c\u7f29contig\u5e38\u89c1\u4e8e\u591a\u500d\u4f53\u7684\u6742\u4ea4\u79cd\uff0c\u9891\u7e41\u6742\u4ea4\u5f15\u5165\u4e86\u8fd1\u4e4e\u4e00\u81f4\u7684\u533a\u57df\uff0c\u8fd9\u4e9b\u533a\u57df\u76ee\u524d\u96be\u4ee5\u88ab\u4ece\u5934\u7ec4\u88c5\u8f6f\u4ef6\u76f4\u63a5\u7ec4\u88c5\u6210\u6b63\u5e38\u7684\u62f7\u8d1d\u3002\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u4e2a\u89e3\u51b3\u65b9\u6848\uff0c\u8be5\u65b9\u6848\u57fa\u4e8econtig\u6d4b\u5e8f\u6df1\u5ea6\uff08HiFi / ONT / Pore-C\uff09\u8ba1\u7b97\u62f7\u8d1d\u6570\u9274\u5b9a\u584c\u7f29contig(CN&gt;=2)\uff0c\u7136\u540e\u901a\u8fc7contig\u672c\u8eab\u548c\u4e92\u4f5c\u4fe1\u53f7\uff0c\u5c06contig\u590d\u5236\u5e76\u63d2\u5165\u5230\u6b63\u786e\u7684\u4f4d\u7f6e\u3002\u8be5\u65b9\u6848\u9002\u7528\u4e8e\u5c11\u91cf\u7684\u584c\u7f29\uff0c\u6682\u65f6\u4e0d\u9002\u7528\u4e8e\u6574\u6761\u67d3\u8272\u4f53\u584c\u7f29\u7684\u60c5\u51b5, \u5927\u91cf\u584c\u7f29\u5e94\u91c7\u7528\u53e6\u5916\u4e00\u79cd\u7b56\u7565\u3002</p>"},{"location":"zh/CLI/collapse/#contig","title":"\u584c\u7f29contig\u9274\u5b9a","text":"HiFi dataONT dataPore-C dataGFA <ul> <li>Custom mapping <pre><code>minimap2 -cx map-hifi -I 16g -t 40 --secondary=no draft.asm.fasta hifi.fastq.gz | pigz -p 10 -c &gt; hifi.align.paf.gz\n\ncphasing-rs paf2depth hifi.align.paf.gz -w 5000 -s 1000 -o hifi.align.depth\ncphasing collapse from-depth hifi.align.depth\n</code></pre></li> </ul> <ul> <li>Directly use the hitig results   <code>output.collapsed.contigs.list</code></li> </ul> <ul> <li>Custom mapping   <pre><code>minimap2 -cx map-ont -I 16g -t 40 --secondary=no draft.asm.fasta ont.fastq.gz | pigz -p 10 -c &gt; ont.align.paf.gz\n\ncphasing-rs paf2depth hifi.align.paf.gz -w 5000 -s 1000 -o ont.align.depth\ncphasing collapse from-depth ont.align.depth\n</code></pre></li> <li>Directly use the hitig results   <code>output.collapsed.contigs.list</code></li> </ul> <p>The <code>porec.align.paf.gz</code> generated from <code>cphasing mapper</code>. <pre><code>cphasing-rs paf2depth porec.align.paf.gz -w 5000 -s 1000 -o porec.align.depth\ncphasing collapse from-depth porec.align.depth\n</code></pre></p> <p>Hifiasm\u8f93\u51fa\u7684GFA \u6587\u4ef6\u91cc\u8bb0\u5f55\u4e86unitig \u7684read number  <pre><code>cphasing collapse from-gfa hifi.p_utg.noseq.gfa.gz \n</code></pre></p>"},{"location":"zh/CLI/collapse/#contig_1","title":"\u584c\u7f29contig\u8865\u6551","text":"<pre><code>cphasing collapse rescue 3.hyperpartition/porec.align.porec.q1.e5m.hg draft.asm.contigsizes 3.hyperpartition/output.clusters.txt contigs.collapsed.contig.list -n 4 -at 3.hyperpartition/draft.asm.allele.table\n</code></pre> <p>Note</p> <p>\u76ee\u524d\uff0c\u6b64\u6b65\u9aa4\u8f93\u51fa\u7684\u4e3a<code>collapsed.rescue.clusters.txt</code>\u683c\u5f0f\uff0c\u9700\u8981\u7528\u6237\u81ea\u884c\u8fd0\u884c\u540e\u7eed\u7684<code>4.scaffolding</code>\u4ee5\u5b8c\u6210contig\u7684\u6392\u5e8f\u548c\u5b9a\u5411\u3002</p>"},{"location":"zh/CLI/collapse/#scaffolding","title":"\u8fd0\u884c\u5b8c<code>scaffolding</code>\u540e","text":"<ul> <li>\u751f\u6210\u4e00\u4e2a\u65b0\u7684contig\u6c34\u5e73\u7684fasta\u548cagp\u6587\u4ef6\uff0c\u4e3b\u8981\u76ee\u7684\u662f\u91cd\u547d\u540d\u590d\u5236\u7684contig(\u5982utg000001l -&gt; utg000001_d2)</li> </ul> <pre><code>cphasing agp2fasta groups.rescued.agp draft.asm.fasta --contigs &gt; draft.dup.fasta\ncphasing collapse agp-dup groups.rescued.agp &gt; groups.dup.agp\n</code></pre> <ul> <li>\u751f\u6210\u65b0\u7684<code>pairs.gz</code> or <code>pairs.pqs</code>\u6587\u4ef6  <pre><code>cphasing collapse pairs-dup sample.pairs.pqs collapsed.rescue.contigs.list -o sample.dup.pairs.pqs \n</code></pre></li> </ul> <ul> <li>Juicebox\u8f93\u5165\u6587\u4ef6 <pre><code>cphasing utils agp2assembly groups.dup.agp &gt; groups.dup.assembly\ncphasing pairs2mnd sample.dup.pairs.pqs -o sample.dup.mnd.txt\n</code></pre></li> </ul> <ul> <li>Rename <pre><code>cphasing rename -r ref.fa -f draft.dup.fasta -a groups.dup.agp -t 40 \n</code></pre></li> </ul> <ul> <li>Plot <pre><code>cphasing pairs2cool sample.dup.pairs.pqs sample.dup.pairs.pqs/_contigsizes sample.10k.cool \ncphasing plot -a groups.dup.agp -m sample.10k.cool -o sample.500k.wg.png \n</code></pre></li> </ul>"},{"location":"zh/CLI/hic_mapper/","title":"HiC Mapper","text":"<p>\u5904\u7406Hi-C\u6570\u636e</p>"},{"location":"zh/CLI/hic_mapper/#one-cell","title":"one cell","text":"<pre><code>cphasing hic mapper -f draft.asm.fasta -1 hic_R1.fastq.gz -2 hic_R2.fastq.gz -t 40\n</code></pre> <p>Note</p> <p>\u5982\u679c\u57fa\u56e0\u7ec4\u5927\u5c0f\u5927\u4e8e8Gb\uff0c\u5e94\u6307\u5b9a\u66f4\u9ad8\u7684kmer\u548cwindow\u5927\u5c0f\uff0c\u4f8b\u5982<code>-k 27 -w 14</code>\uff0c\u907f\u514d<code>chromap</code>\u62a5\u9519\u3002</p>"},{"location":"zh/CLI/hic_mapper/#cellhi-c","title":"\u5c06\u4e0d\u540ccell\u7684Hi-C \u6570\u636e\u63d0\u4ea4\u5230\u96c6\u7fa4","text":"<ul> <li>\u5c06\u591a\u4e2a\u811a\u672c\u63d0\u4ea4\u5230\u4e0d\u540c\u7684\u8282\u70b9 run_sample1.sh<pre><code>cphasing hic mapper -f draft.asm.fasta -1 hic-1_R1.fastq.gz -2 hic-1_R2.fastq.gz -t 40\n</code></pre>run_sample2.sh<pre><code>cphasing hic mapper -f draft.asm.fasta -1 hic-2_R1.fastq.gz -2 hic-2_R2.fastq.gz -t 40\n</code></pre> run_sample3.sh<pre><code>cphasing hic mapper -f draft.asm.fasta -1 hic-3_R1.fastq.gz -2 hic-3_R2.fastq.gz -t 40\n</code></pre> </li> </ul> <p>Note</p> <p>\u56e0\u4e3a\u6709\u4e00\u6b65\u521b\u5efa\u7d22\u5f15\u7684\u6b65\u9aa4\uff0c\u56e0\u6b64\u7528\u6237\u9700\u8981\u5148\u63d0\u4ea4\u4e00\u4e2a\u4efb\u52a1\uff0c\u76f4\u5230\u7d22\u5f15\u521b\u5efa\u5b8c\u6210\u518d\u63d0\u4ea4\u5269\u4e0b\u7684\u4efb\u52a1\uff0c\u6216\u8005\u5728\u4e0d\u540c\u7684\u76ee\u5f55\u4e0b\u5206\u522b\u63d0\u4ea4\u3002</p> <ul> <li>\u5408\u5e76\u7ed3\u679c \u5c06\u591a\u4e2a<code>.pairs.gz</code>\u6587\u4ef6\u5408\u5e76\u6210\u4e00\u4e2a\u3002 <pre><code>cphasing pairs-merge hic-*.pairs.pqs -o hic.merge.pairs.pqs\n</code></pre></li> </ul>"},{"location":"zh/CLI/mapper/","title":"Mapper","text":"<p><code>cphasing mapper</code> \u662f\u7528\u6765\u5904\u7406Pore-C\u6216\u8005HiFi-C\u6570\u636e\u7684\uff0c\u5b83\u8f93\u51fa\u4e24\u4e2a\u6587\u4ef6:       \uff081\uff09\u5b58\u50a8\u9ad8\u9636\u4e92\u4f5c\u4fe1\u606f\u7684porec table(<code>.porec.gz</code>)     \uff082\uff09\u5b58\u50a8\u865a\u62df\u6210\u5bf9\uff08VPC\uff09\u4e92\u4f5c\u76844DN pairs (<code>.pairs.pqs</code>) </p> <p>Note</p> <p>HiFi-C\u6570\u636e\u76ee\u524d\u4e5f\u4ee5<code>.porec.gz</code>\u540e\u7f00\u547d\u540d\uff0c\u5185\u5bb9\u662f\u4e00\u6837\u7684\u3002</p>"},{"location":"zh/CLI/mapper/#_1","title":"\u793a\u4f8b","text":""},{"location":"zh/CLI/mapper/#cellpore-c","title":"\u5904\u7406\u5355\u4e2acell\u7684Pore-C\u6570\u636e","text":"<pre><code>cphasing mapper draft.contigs.fasta sample.porec.fastq.gz -t 40 \n</code></pre>"},{"location":"zh/CLI/mapper/#cellpore-c_1","title":"\u5904\u7406\u591a\u4e2acell\u7684Pore-C\u6570\u636e","text":""},{"location":"zh/CLI/mapper/#_2","title":"\u4e00\u4e2a\u811a\u672c\u5b8c\u6210\u6bd4\u5bf9","text":"<p><pre><code>cphasing mapper draft.contigs.fasta sample1.porec.fastq.gz sample2.porec.fastq.gz -t 40 \n</code></pre> or  <pre><code>cphasing mapper draft.contigs.fasta sample*.porec.fastq.gz -t 40 \n</code></pre></p> <p>Note</p> <p>\u7ed3\u679c\u4f7f\u7528\u7b2c\u4e00\u4e2a\u6587\u4ef6\u7684\u524d\u7f00\u4f5c\u4e3a\u8f93\u51fa\u524d\u7f00</p>"},{"location":"zh/CLI/mapper/#_3","title":"\u5206\u522b\u63d0\u4ea4\u5230\u96c6\u7fa4","text":"<ul> <li>\u4f7f\u7528\u591a\u4e2a\u811a\u672c\u63d0\u4ea4\u4efb\u52a1\u5230\u4e0d\u540c\u8282\u70b9 run_sample1.sh<pre><code>cphasing mapper draft.contigs.fasta sample1.porec.fastq.gz -t 40\n</code></pre> run_sample2.sh<pre><code>cphasing mapper draft.contigs.fasta sample2.porec.fastq.gz -t 40\n</code></pre> run_sample3.sh<pre><code>cphasing mapper draft.contigs.fasta sample3.porec.fastq.gz -t 40\n</code></pre></li> </ul> <ul> <li>\u5408\u5e76\u7ed3\u679c <pre><code>cphasing-rs porec-merge sample1.porec.porec.gz sample2.porec.porec.gz sample3.porec.porec.gz -o sample.merge.porec.gz\ncphasing-rs pairs-merge sample1.porec.pairs.pqs sample2.porec.pairs.pqs sample3.porec.pairs.pqs -o sample.merge.pairs.pqs\n</code></pre></li> </ul>"},{"location":"zh/CLI/mapper/#cellhifi-c","title":"\u5904\u7406\u5355\u4e2acell\u7684HiFi-C\u6570\u636e","text":"<pre><code>cphasing mapper draft.contigs.fasta sample.porec.fastq.gz -t 40 --mm2-params \"-x map-hifi\"\n</code></pre>"},{"location":"zh/CLI/mapper/#cellhifi-c_1","title":"\u5904\u7406\u591a\u4e2acell\u7684HiFi-C\u6570\u636e","text":"<p>\u4e0e\u5904\u7406Pore-C\u6570\u636e\u7684\u6b65\u9aa4\u4e00\u81f4\uff0c\u4f46\u9700\u8981\u52a0<code>--mm2-params \"-x map-hifi\"</code>\u53c2\u6570\u3002</p>"},{"location":"zh/CLI/methalign/","title":"Methalign","text":"<p>\u4e3a\u4e86\u63d0\u5347\u6bd4\u5bf9\u7684\u7cbe\u5ea6\uff0c\u7279\u522b\u662f\u9ad8\u5ea6\u540c\u6e90\u533a\u57df\u7684\u4e92\u4f5c\u6570\u91cf\uff0c\u6211\u4eec\u5f00\u53d1\u4e86\u4e00\u4e2a\u6a21\u5757<code>Methalign</code>\u3002\u5c1d\u8bd5\u4f7f\u7528\u7532\u57fa\u5316\u4fe1\u606f(5mCG)\uff0c\u5bf9\u6a21\u7cca\u7684\u6bd4\u5bf9\u8fdb\u884c\u4e8c\u6b21\u5206\u914d\u3002\u8fd9\u4e2a\u6a21\u5757\u4e3b\u8981\u9488\u5bf9\u8d85\u590d\u6742\u591a\u500d\u4f53\uff0c\u5b83\u4eec\u5b58\u5728\u5927\u91cf\u7684\u9ad8\u5ea6\u540c\u6e90\u533a\u57df\uff0c\u8fd9\u4e9b\u533a\u57df\uff0c\u5373\u4f7f\u4f7f\u7528\u957f\u5ea6\u957f\u7684\u4e92\u4f5c\u6570\u636e\u4e5f\u96be\u4ee5\u533a\u5206\u3002\u666e\u901a\u591a\u500d\u4f53\u8bf7\u4f7f\u7528<code>Mapper</code>\u5904\u7406Pore-C\u6570\u636eMapper\u3002</p> <p>Info</p> <p>\u5982\u679c\u4f60\u4e0d\u9700\u8981\u4f7f\u7528\u7532\u57fa\u5316\u4fe1\u606f\uff0c\u8bf7\u4f7f\u7528 Mapper</p> <p>Note</p> <p>\u8f93\u5165\u7684bam\u6587\u4ef6\u5e94\u8be5\u5305\u542b<code>MM/ML</code>tags</p>"},{"location":"zh/CLI/methalign/#methalign_1","title":"\u6fc0\u6d3b methalign\u73af\u5883","text":"<pre><code>source activate_cphasing methalign\n</code></pre> <p>Info</p> <p>\u7b2c\u4e00\u6b21\u6fc0\u6d3b\uff0c\u8bf7\u5728\u6709\u7f51\u7edc\u7684\u60c5\u51b5\u4e0b\u8fd0\u884c\u8be5\u547d\u4ee4</p>"},{"location":"zh/CLI/methalign/#contig5mcg","title":"\u8ba1\u7b97contig\u6c34\u5e73\u57fa\u56e0\u7ec4\u76845mCG\u4fe1\u606f","text":"HiFi readsONT reads <p>Align the HiFi reads by pbmm2</p> <pre><code>pbmm2 index --preset CCS contigs.fasta index.mmi \npbmm2 align --preset CCS index.mmi HiFi_reads.bam | samtools view - -b -o HiFi.align.bam\nsamtools sort HiFi.align.bam -o HiFi.align.sorted.bam\nsamtools index HiFi.align.sorted.bam\n</code></pre> <p>Calculate the 5mC sites by pb-cpg-tools <pre><code>aligned_bam_to_cpg_scores --bam HiFi.align.sorted.bam --ref contigs.fasta --model pileup_calling_model.v1.tflite --modsites-mode reference\nawk '{print $1,$2,$3,$9}' OFS='\\t' HiFi_align_sorted_bam_to_cpg_scores.combined.bed &gt; output.methyl.bg\n</code></pre></p> <p>Align the ONT reads by dorado</p> <pre><code>dorado aligner contigs.fasta ont_reads.bam -t 20 | samtools view -q 1 -@ 10 -b | samtools sort -@ 10 &gt; ont.align.sorted.bam \nsamtools index ont.align.sorted.bam \n</code></pre> <p>Calculate the 5mC sites by modkit</p> <pre><code>modkit pileup ont.align.sorted.bam output.methyl.bed --log-filepath pileup.log --cpg --ref contigs.fasta -t 60 --combine-strands\nawk '{print $1,$2,$3,$11}' OFS='\\t' output.methyl.bed &gt; output.methyl.bg\n</code></pre>"},{"location":"zh/CLI/methalign/#pore-chifi-ccontig","title":"\u5c06Pore-C\u6216\u8005HiFi-C\u6bd4\u5bf9\u5230contig\u6c34\u5e73\u57fa\u56e0\u7ec4\u4e0a","text":"<pre><code>dorado aligner contigs.fasta porec_reads.bam --secondary=yes &gt; porec.align.bam\n</code></pre> <p>Note</p> <p>Replace <code>--secondary=yes</code> to <code>--mm2-opts \"--secondary=yes\"</code> when using dorado &gt;= 0.8.0</p>"},{"location":"zh/CLI/methalign/#_1","title":"\u4e8c\u6b21\u5206\u914d\u6bd4\u5bf9\u7247\u6bb5","text":"<ul> <li>\u5c06bam\u6587\u4ef6\u5206\u5272\u6210\u591a\u4efd\u4ee5\u52a0\u5feb\u5904\u7406\u901f\u5ea6 <pre><code>cphasing-rs split-bam porec.align.bam -o split_outdir/output.split\ncd split_outdir\n</code></pre></li> </ul> <ul> <li>\u4e8c\u6b21\u5206\u914d\u6bd4\u5bf9\u7247\u6bb5 <pre><code>methalign refine -t 20 contigs.fasta output.methyl.bg output.split_*.bam -o porec.align.refined.paf.gz\n</code></pre></li> </ul> <p>Note</p> <p>\u8fd9\u6b65\u4f1a\u751f\u6210\u4e24\u4e2a\u6587\u4ef6<code>porec.align.refined.paf.gz</code>\u548c<code>porec.align.refined.porec.gz</code>\u3002</p> <ul> <li>\u4e4b\u540e\u4f7f\u7528<code>cphasing pipeline</code>\u5b8c\u6210\u5206\u578b\u7ec4\u88c5</li> </ul> <pre><code>cphasing pipeline -f contigs.fasta -pct porec.align.refined.porec.gz -t 10 -n 8:4 -hcr -p AAGCTT \n</code></pre>"},{"location":"zh/CLI/plot/#_1","title":"\u793a\u4f8b","text":""},{"location":"zh/CLI/plot/#contig","title":"\u4ececontig\u6c34\u5e73\u6bd4\u5bf9\u7ed3\u679c\u7ed8\u5236\u70ed\u56fe","text":"<ul> <li>\u5c06<code>pairs</code>\u6587\u4ef6\u8f6c\u6210<code>.cool</code>\u77e9\u9635\u6587\u4ef6</li> </ul> pairs.pqspairs.gz <pre><code>cphasing-rs contigsizes contigs.fa &gt; contigs.contigsizes\ncphasing pairs2cool sample.pairs.pqs contigs.contigsizes sample.10k.cool\n</code></pre> <pre><code>cphasing-rs contigsizes contigs.fa &gt; contigs.contigsizes\ncphasing pairs2cool sample.pairs.gz contigs.contigsizes sample.10k.cool\n</code></pre> <ul> <li>\u6839\u636eAGP\u6587\u4ef6\u7ed8\u5236\u70ed\u56fe     \u6839\u636eAGP\u6587\u4ef6\u5c06contig\u6c34\u5e73\u7684<code>.cool</code>\u77e9\u9635\u8f6c\u6210\u67d3\u8272\u4f53\u6c34\u5e73\uff0c\u5e76\u7ed8\u5236\u70ed\u56fe<pre><code>cphasing plot -a groups.agp -m sample.10k.cool -o groups.500k.wg.png   \n</code></pre> </li> </ul> <p>Note</p> <p>\u8fd9\u6b65\u4f1a\u4ea7\u751f\u4e24\u4e2a\u6587\u4ef6\u4e00\u4e2a\u662f<code>sample.10k.chrom.cool</code> and <code>sample.500k.chrom.cool</code>\uff0c\u540e\u7eed\u5728agp\u6587\u4ef6\u4e0d\u53d8\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e24\u4e2a\u6587\u4ef6\u8fdb\u884c\u70ed\u56fe\u7684\u8c03\u6574.</p> <p> groups.500k.wg.png </p>"},{"location":"zh/CLI/plot/#cool","title":"\u76f4\u63a5\u4f7f\u7528<code>.cool</code> \u6587\u4ef6\u7ed8\u5236\u70ed\u56fe","text":"<pre><code>cphasing plot -m sample.100k.chrom.cool -o groups.100k.wg.png \n</code></pre> <p>Note</p> <p>\u7528\u6237\u53ef\u4ee5\u6307\u5b9a<code>--binsize</code>\u53c2\u6570\u6765\u8c03\u6574\u70ed\u56fe\u7684\u5206\u8fa8\u7387\uff0c\u5982\u679c\u8f93\u5165\u77e9\u9635\u7684\u5206\u8fa8\u7387\u8ddf\u8bbe\u5b9a\u7684\u5206\u8fa8\u7387\u4e0d\u4e00\u81f4\uff0c\u7a0b\u5e8f\u4f1a\u81ea\u52a8\u751f\u6210\u65b0\u7684\u5206\u8fa8\u7387\u7ed8\u5236\u70ed\u56fe\uff0c\u4f46\u9700\u8981\u8bbe\u5b9a\u7684\u5206\u8fa8\u7387\u548c\u8f93\u5165\u77e9\u9635\u7684\u5206\u8fa8\u7387\u5448\u6574\u6570\u500d\u7684\u5173\u7cfb\u3002\u4f8b\u5982\uff0c\u8f93\u5165100k.cool\uff0c\u60f3\u7ed8\u5236500k\u5206\u8fa8\u7387\u7684\u70ed\u56fe:</p> <pre><code>cphasing plot -m sample.100k.chrom.cool -o groups.500k.wg.png -bs 500k\n</code></pre> <p> groups.100k.wg.png groups.500k.wg.png <p></p>"},{"location":"zh/CLI/plot/#_2","title":"\u4e0d\u540c\u53c2\u6570\u7ed8\u5236\u7684\u70ed\u56fe","text":""},{"location":"zh/CLI/plot/#_3","title":"\u540c\u6e90\u67d3\u8272\u4f53\u7ec4\u52a0\u8fb9\u6846","text":"<p><pre><code>cphasing plot chrom.500k.cool -o chrom.500k.png --whitered --add-hap-border\n</code></pre> </p>"},{"location":"zh/CLI/plot/#_4","title":"\u6307\u5b9a\u67d3\u8272\u4f53\u7ed8\u5236","text":""},{"location":"zh/CLI/plot/#_5","title":"\u5c06\u6bcf\u6761\u67d3\u8272\u4f53\u5206\u5f00\u7ed8\u5236","text":""},{"location":"zh/CLI/plot/#parameters-of-plot","title":"Parameters of plot","text":"cphasing plot -h<pre><code> Usage: cphasing plot [OPTIONS]                                             \n\n Adjust or Plot the contacts matrix after assembling.                       \n\n \u258c Usage:                                                                   \n \u258c  \u2022 adjust the matrix by agp and plot a heatmap                           \n\n\n  cphasing plot -a groups.agp -m sample.10000.cool -o groups.500k.wg.png    \n\n\n \u258c  \u2022 adjust the matrix by agp and plot a 100k resolution heatmap           \n\n\n  cphasing plot -a groups.agp \\                                             \n      -m sample.10000.cool \\                                                \n      -o groups.100k.wg.png \\                                               \n      -bs 100k                                                              \n\n\n \u258c  \u2022 only plot a heatmap                                                   \n\n\n  cphasing plot -m sample.100k.cool -o sample.100k.png                      \n\n\n \u258c  \u2022 Plot some chromosomes                                                 \n\n\n  cphasing plot -m sample.100k.cool -c Chr01,Chr02 -o Chr01_Chr02.100k.png  \n\n\n\u256d\u2500 Options of Matrix Operation \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 *  --matrix        -m   Contacts matrix stored by Cool format.           \u2502\n\u2502                         (COOL)                                           \u2502\n\u2502                         [required]                                       \u2502\n\u2502    --binsize       -bs  Bin size of the heatmap you want to plot.        \u2502\n\u2502                         Enabled suffix with k or m. [defalt: input       \u2502\n\u2502                         matrix binsize]                                  \u2502\n\u2502                         (STR)                                            \u2502\n\u2502    --only-coarsen       Only coarsen the input matrix, do not need plot  \u2502\n\u2502                         the heatmap.                                     \u2502\n\u2502    --balance            balance the matrix.                              \u2502\n\u2502    --balanced           Plot balanced values, which need cool have       \u2502\n\u2502                         weights columns in bins.                         \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n\u256d\u2500 Options of AGP Adjustment \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 --agp          -a  (AGP)                                                 \u2502\n\u2502 --only-adjust      Only adjust the matrix by agp, do not need plot the   \u2502\n\u2502                    heatmap.                                              \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n\u256d\u2500 Options of Heatmap \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 --chromosomes                   -c         Chromosomes and order in      \u2502\n\u2502                                            which the chromosomes should  \u2502\n\u2502                                            be plotted. Comma seperated.  \u2502\n\u2502                                            or a one column file          \u2502\n\u2502                                            (TEXT)                        \u2502\n\u2502 --regex                         -r         Regular expression of         \u2502\n\u2502                                            chromosomes, only used for    \u2502\n\u2502                                            --chromosomes, e.g. Chr01g.*  \u2502\n\u2502 --disable-natural-sort          -dns       Disable natural sort of       \u2502\n\u2502                                            chromosomes, only used for    \u2502\n\u2502                                            --chromosomes or --only-chr   \u2502\n\u2502 --per-chromosomes,--per-chrom\u2026  -pc        Instead of plotting the whole \u2502\n\u2502                                            matrix, each chromosome is    \u2502\n\u2502                                            plotted next to the other.    \u2502\n\u2502 --only-chr                      -oc        Only plot the chromosomes     \u2502\n\u2502                                            that ignore unanchored        \u2502\n\u2502                                            contigs. When --chromosomes   \u2502\n\u2502                                            specifed, this parameter will \u2502\n\u2502                                            be ignored. The default use   \u2502\n\u2502                                            prefix of Chr to find the     \u2502\n\u2502                                            chromosomes. --chr-prefix can \u2502\n\u2502                                            be used to change this.       \u2502\n\u2502 --chr-prefix                    -cp        Prefix of the chromosomes,    \u2502\n\u2502                                            only used for --only-chr      \u2502\n\u2502                                            (STR)                         \u2502\n\u2502                                            [default: Chr]                \u2502\n\u2502 --chrom-per-row                 -cpr       Number of chromosome plot in  \u2502\n\u2502                                            each row                      \u2502\n\u2502                                            (INTEGER)                     \u2502\n\u2502                                            [default: 4]                  \u2502\n\u2502 --vmin                          -vmin      (FLOAT)                       \u2502\n\u2502 --vmax                          -vmax      (FLOAT)                       \u2502\n\u2502 --scale                         -s         Method of contact             \u2502\n\u2502                                            normalization                 \u2502\n\u2502                                            (STR)                         \u2502\n\u2502                                            [default: log1p]              \u2502\n\u2502 --triangle                                 Plot the heatmap in triangle  \u2502\n\u2502 --fontsize                                 Fontsize of the ticks,        \u2502\n\u2502                                            default is auto               \u2502\n\u2502                                            (INT)                         \u2502\n\u2502 --dpi                           -dpi       Resolution for the image.     \u2502\n\u2502                                            (INTEGER)                     \u2502\n\u2502                                            [default: 600]                \u2502\n\u2502 --cmap,--colormap               -cmap,-cm  Colormap of heatmap.          \u2502\n\u2502                                            Available values can be seen  \u2502\n\u2502                                            :                             \u2502\n\u2502                                            https://pratiman-91.github.i\u2026 \u2502\n\u2502                                            and                           \u2502\n\u2502                                            http://matplotlib.org/exampl\u2026 \u2502\n\u2502                                            and whitered .                \u2502\n\u2502                                            (TEXT)                        \u2502\n\u2502                                            [default: redp1_r]            \u2502\n\u2502 --whitered                      -wr        Preset of --scale none        \u2502\n\u2502                                            --colormap whitered           \u2502\n\u2502 --hap-pattern                   -hp        Regex pattern of haplotype    \u2502\n\u2502                                            (STR)                         \u2502\n\u2502                                            [default: (Chr\\d+)g(\\d+)]     \u2502\n\u2502 --add-hap-border                           Add border between haplotypes,\u2502\n\u2502                                            effective when --hap-pattern  \u2502\n\u2502                                            is set consistent with the    \u2502\n\u2502                                              chromosome name.            \u2502\n\u2502 --no-lines                      -nl        Don't add dash line in        \u2502\n\u2502                                            chromosome boundaries.        \u2502\n\u2502 --no-ticks                      -nt        Don't add ticks both in x     \u2502\n\u2502                                            axis and y axis.              \u2502\n\u2502 --rotate-xticks                 -rx        Rotate the x ticks            \u2502\n\u2502                                            [default: True]               \u2502\n\u2502 --rotate-yticks                 -ry        Rotate the x ticks            \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n\u256d\u2500 Global Options \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 --output   -o        Output path of file.                                \u2502\n\u2502                      (TEXT)                                              \u2502\n\u2502                      [default: plot.heatmap.png]                         \u2502\n\u2502 --threads  -t        Number of threads. Used in matrix balance.          \u2502\n\u2502                      (INT)                                               \u2502\n\u2502                      [default: 8]                                        \u2502\n\u2502 --help     -help,-h  Show this message and exit.                         \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n</code></pre>"},{"location":"zh/CLI/rename/","title":"Rename","text":"<p>\u4ee5\u5355\u500d\u578b\u6216\u8005\u8fd1\u7f18\u7269\u79cd\u7684\u53c2\u8003\u57fa\u56e0\u7ec4\u4f5c\u4e3a\u53c2\u8003\uff0c\u5c06\u5f53\u524d\u7ec4\u88c5\u7684\u591a\u500d\u4f53\u8fdb\u884c\u91cd\u547d\u540d\u548c\u67d3\u8272\u4f53\u65b9\u5411\u8c03\u6574.</p>"},{"location":"zh/CLI/rename/#phasing-mode","title":"\u8c03\u6574<code>phasing</code> mode\u7684\u7ec4\u88c5\u7ed3\u679c","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b<code>phasing</code> mode\u5df2\u7ecf\u5c06\u540c\u6e90\u67d3\u8272\u4f53\u805a\u6210\u4e00\u7ec4\uff0c\u5e76\u4e14\u4e0d\u540c\u540c\u6e90\u67d3\u8272\u4f53\u5c06\u7684\u65b9\u5411\u5df2\u7ecf\u8c03\u6574\u81f3\u5e73\u884c\uff0c\u4e3a\u4e86\u8282\u7701\u65f6\u95f4\u5f00\u9500\uff0c\u6211\u4eec\u4ec5\u5c06\u7b2c\u4e00\u4e2a\u5355\u500d\u578b\u5373<code>Chr??.g1</code>\u6bd4\u5bf9\u81f3\u53c2\u8003\u57fa\u56e0\u7ec4\u4e0a\uff0c\u5269\u4e0b\u7684\u5355\u500d\u578b\u547d\u540d\u548c\u65b9\u5411\u8ddf\u968f<code>g1</code>\u8fdb\u884c\u8c03\u6574\u3002\u5982\u679c\u4e0d\u7b26\u5408\u4ee5\u4e0a\u8bf4\u660e\uff0c\u5219\u9700\u52a0<code>--unphased</code>\u53c2\u6570\u5bf9\u6240\u6709\u67d3\u8272\u4f53\u8fdb\u884c\u6bd4\u5bf9\u3002 <pre><code>cphasing rename -r mono.fa -f draft.asm.fasta -a groups.agp -t 20 \n</code></pre> </p>"},{"location":"zh/CLI/rename/#_1","title":"\u5bf9\u6240\u6709\u67d3\u8272\u4f53\u8fdb\u884c\u91cd\u547d\u540d","text":"<p><code>basal</code>\u6216\u8005<code>basal_withprune</code> mode\uff0c\u9700\u8981\u5bf9\u6240\u6709\u67d3\u8272\u4f53\u8fdb\u884c\u6bd4\u5bf9\uff0c\u7136\u540e\u91cd\u547d\u540d\u548c\u91cd\u65b0\u8c03\u6574\u65b9\u5411\uff0c\u9700\u8981\u52a0<code>--unphased</code>\u53c2\u6570\u3002 <pre><code>cphasing rename -r mono.fa -f draft.asm.fasta -a groups.agp -t 20 --unphased \n</code></pre></p> <p></p>"},{"location":"zh/CLI/rename/#_2","title":"\u7528\u5b57\u6bcd\u4f5c\u4e3a\u4e0d\u540c\u5355\u500d\u578b\u7684\u540e\u7f00","text":"<p><code>Chr01A Chr01B Chr01C ...</code> <pre><code>cphasing rename -r mono.fa -f draft.asm.fasta -a groups.agp -t 20 -s upperletter\n</code></pre></p> <p></p>"},{"location":"zh/tutorials/hic/hic_decaploid/","title":"\u540c\u6e90\u5341\u500d\u4f53\u7ec4\u88c5(Hi-C)","text":"<p>\u540c\u6e90\u5341\u500d\u4f53 (2n=8x=80)</p> <pre><code>cphasing pipeline -f decaploid_hifi.bp.p_utg.fasta -hic1 hic_R1.fastq.gz -hic2 hic_R2.fastq.gz -t 40 -n 8:10 -hcr -p AAGCTT \n</code></pre>"},{"location":"zh/tutorials/hic/hic_monoploid/","title":"\u5355\u500d\u4f53\u6216\u5355\u5957\u57fa\u56e0\u7ec4\u7684\u6302\u8f7d","text":"<p>C-Phasing\u4e5f\u652f\u6301\u5355\u500d\u4f53\u7684\u6302\u8f7d\uff0c\u53ea\u9700\u8bbe\u7f6e<code>-n n</code>, \u6216\u8005\u8bbe\u7f6e<code>--mode haploid</code>. </p> <p>\u4f8b\u5982\u4e00\u4e2aDiploid (2n=2x=24)\uff1a</p> <pre><code>cphasing pipeline -f monoploid_ctg.fasta -hic1 hic_R1.fastq.gz -hic2 hic_R2.fastq.gz -t 40 -n 12\n</code></pre>"},{"location":"zh/tutorials/hic/hic_sugarcane/","title":"\u73b0\u4ee3\u683d\u57f9\u7518\u8517\u7ec4\u88c5(Hi-C)","text":"<p>\u975e\u6574\u500d (2n=114), \u9884\u4f30\u57fa\u56e0\u7ec4\u5927\u5c0f ~ 10 Gb </p>"},{"location":"zh/tutorials/hic/hic_sugarcane/#hi-c_1","title":"Hi-C\u6570\u636e\u5904\u7406","text":"<p>\u7531\u4e8eHi-C\u6570\u636e\u91cf\u5927\uff0c\u6211\u4eec\u5c06\u6bcf\u4e2acell\u7684Hi-C\u6570\u636e\u5206\u522b\u63d0\u4ea4\u5230\u4e0d\u540c\u7684\u8282\u70b9\u4e0a\u8fdb\u884c\u6bd4\u5bf9\uff0c\u7136\u540e\u518d\u5408\u5e76\u6210\u4e00\u4e2a\u6587\u4ef6\u3002</p> <p>Note</p> <p>\u56e0\u4e3a<code>hic mapper</code>\u91cc\u9762\u6709\u4e00\u6b65\u7d22\u5f15\u6784\u5efa\uff0c\u7528\u6237\u9700\u8981\u5148\u63d0\u4ea4\u4e00\u4e2a\u4efb\u52a1\uff0c\u7b49\u5230\u7d22\u5f15\u521b\u5efa\u5b8c\u6210\u518d\u63d0\u4ea4\u5269\u4f59\u7684\u4efb\u52a1\u3002</p> <pre><code>cphasing hic mapper -f sh_hifi.bp.p_utg.fasta -hic1 hic-1_R1.fastq.gz -hic2 hic-1_R2.fastq.gz -t 40 -k 27 -w 14 \n</code></pre> <pre><code>cphasing hic mapper -f sh_hifi.bp.p_utg.fasta -hic1 hic-2_R1.fastq.gz -hic2 hic-2_R2.fastq.gz -t 40 -k 27 -w 14 \ncphasing hic mapper -f sh_hifi.bp.p_utg.fasta -hic1 hic-3_R1.fastq.gz -hic2 hic-3_R2.fastq.gz -t 40 -k 27 -w 14 \ncphasing hic mapper -f sh_hifi.bp.p_utg.fasta -hic1 hic-4_R1.fastq.gz -hic2 hic-4_R2.fastq.gz -t 40 -k 27 -w 14 \n</code></pre> <pre><code>cphasing pairs-merge hic-*.pairs.pqs -o hic.merge.pairs.pqs\n</code></pre>"},{"location":"zh/tutorials/hic/hic_sugarcane/#_1","title":"\u7ec4\u88c5\u6d41\u7a0b","text":"<p>\u73b0\u4ee3\u683d\u57f9\u7518\u8517\u5c5e\u4e8e\u975e\u6574\u500d\u4f53\uff0c\u4e0d\u540c\u540c\u6e90\u67d3\u8272\u4f53\u7ec4\u5185\u7684\u67d3\u8272\u4f53\u6570\u91cf\u4e0d\u540c\uff0c\u56e0\u6b64\u6211\u4eec\u503e\u5411\u4e8e\u5148\u8ba9\u7a0b\u5e8f\u81ea\u884c\u5206\u7ec4\u770b\u770b\uff08<code>-n 0:0</code>)\u3002 <pre><code>cphasing pipeline -f sh_hifi.bp.p_utg.fasta -pct hic.mrege.pairs.pqs -t 40 -n 0:0 -hcr -p AAGCTT \n</code></pre></p>"},{"location":"zh/tutorials/porec/porec_decaploid/","title":"\u540c\u6e90\u5341\u500d\u4f53\u7ec4\u88c5(Pore-C)","text":"<p>\u540c\u6e90\u5341\u500d\u4f53(2n=8x=80)</p> <pre><code>cphasing pipeline -f decaploid_hifi.bp.p_utg.fasta -pcd porec.fastq.gz -t 40 -n 8:10 -hcr -p AAGCTT \n</code></pre>"},{"location":"zh/tutorials/porec/porec_monoploid/","title":"\u5355\u500d\u4f53\u6216\u5355\u5957\u57fa\u56e0\u7ec4\u7684\u6302\u8f7d","text":"<p>C-Phasing\u4e5f\u652f\u6301\u5355\u500d\u4f53\u7684\u6302\u8f7d\uff0c\u53ea\u9700\u8bbe\u7f6e<code>-n n</code>, \u6216\u8005\u8bbe\u7f6e<code>--mode haploid</code>. </p> <p>\u4f8b\u5982\u4e00\u4e2aDiploid (2n=2x=24)\uff1a</p> <pre><code>cphasing pipeline -f monoploid_ctg.fasta -pcd porec.fastq.gz -t 40 -n 12\n</code></pre>"},{"location":"zh/tutorials/porec/porec_sugarcane/","title":"\u73b0\u4ee3\u683d\u57f9\u7518\u8517\u7ec4\u88c5(Pore-C)","text":"<p>\u975e\u6574\u500d (2n=114), \u9884\u4f30\u57fa\u56e0\u7ec4\u5927\u5c0f ~ 10 Gb </p>"},{"location":"zh/tutorials/porec/porec_sugarcane/#pore-c_1","title":"Pore-C\u6570\u636e\u5904\u7406","text":"<p>\u7531\u4e8ePore-C\u6570\u636e\u91cf\u5927\uff0c\u6211\u4eec\u5c06\u6bcf\u4e2acell\u7684Pore-C\u6570\u636e\u5206\u522b\u63d0\u4ea4\u5230\u4e0d\u540c\u7684\u8282\u70b9\u4e0a\u8fdb\u884c\u6bd4\u5bf9\uff0c\u7136\u540e\u518d\u5408\u5e76\u6210\u4e00\u4e2a\u6587\u4ef6\u3002 <code>cphasing porec-merge</code> <pre><code>cphasing mapper sh_hifi.bp.p_utg.fasta porec-1.fastq.gz -t 40 \ncphasing mapper sh_hifi.bp.p_utg.fasta porec-2.fastq.gz -t 40 \ncphasing mapper sh_hifi.bp.p_utg.fasta porec-3.fastq.gz -t 40 \ncphasing mapper sh_hifi.bp.p_utg.fasta porec-4.fastq.gz -t 40 \ncphasing mapper sh_hifi.bp.p_utg.fasta porec-5.fastq.gz -t 40 \n</code></pre></p> <pre><code>cphasing porec-merge porec-*.porec.gz -o porec.merge.porec.gz \n</code></pre>"},{"location":"zh/tutorials/porec/porec_sugarcane/#_1","title":"\u7ec4\u88c5\u6d41\u7a0b","text":"<p>\u73b0\u4ee3\u683d\u57f9\u7518\u8517\u5c5e\u4e8e\u975e\u6574\u500d\u4f53\uff0c\u4e0d\u540c\u540c\u6e90\u67d3\u8272\u4f53\u7ec4\u5185\u7684\u67d3\u8272\u4f53\u6570\u91cf\u4e0d\u540c\uff0c\u56e0\u6b64\u6211\u4eec\u503e\u5411\u4e8e\u5148\u8ba9\u7a0b\u5e8f\u81ea\u884c\u5206\u7ec4\u770b\u770b\uff08<code>-n 0:0</code>)\u3002 <pre><code>cphasing pipeline -f sh_hifi.bp.p_utg.fasta -pct porec.mrege.porec.gz -t 40 -n 0:0 -hcr -p AAGCTT \n</code></pre></p>"}]}